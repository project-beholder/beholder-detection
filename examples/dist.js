!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("mathjs")):"function"==typeof define&&define.amd?define(["mathjs"],e):"object"==typeof exports?exports["beholder-detection"]=e(require("mathjs")):t["beholder-detection"]=e(t.mathjs)}(window,(function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=36)}([function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.NO_IL=e.NO=e.MemoryStream=e.Stream=void 0;var o=n(26),s=n(28),a=o.default(s.getPolyfill()),u={};function c(){}function l(t){for(var e=t.length,n=Array(e),r=0;r<e;++r)n[r]=t[r];return n}function f(t,e,n){try{return t.f(e)}catch(t){return n._e(t),u}}e.NO=u;var h={_n:c,_e:c,_c:c};function p(t){t._start=function(t){t.next=t._n,t.error=t._e,t.complete=t._c,this.start(t)},t._stop=t.stop}e.NO_IL=h;var d=function(){function t(t,e){this._stream=t,this._listener=e}return t.prototype.unsubscribe=function(){this._stream._remove(this._listener)},t}(),m=function(){function t(t){this._listener=t}return t.prototype.next=function(t){this._listener._n(t)},t.prototype.error=function(t){this._listener._e(t)},t.prototype.complete=function(){this._listener._c()},t}(),y=function(){function t(t){this.type="fromObservable",this.ins=t,this.active=!1}return t.prototype._start=function(t){this.out=t,this.active=!0,this._sub=this.ins.subscribe(new m(t)),this.active||this._sub.unsubscribe()},t.prototype._stop=function(){this._sub&&this._sub.unsubscribe(),this.active=!1},t}(),v=function(){function t(t){this.type="merge",this.insArr=t,this.out=u,this.ac=0}return t.prototype._start=function(t){this.out=t;var e=this.insArr,n=e.length;this.ac=n;for(var r=0;r<n;r++)e[r]._add(this)},t.prototype._stop=function(){for(var t=this.insArr,e=t.length,n=0;n<e;n++)t[n]._remove(this);this.out=u},t.prototype._n=function(t){var e=this.out;e!==u&&e._n(t)},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){if(--this.ac<=0){var t=this.out;if(t===u)return;t._c()}},t}(),g=function(){function t(t,e,n){this.i=t,this.out=e,this.p=n,n.ils.push(this)}return t.prototype._n=function(t){var e=this.p,n=this.out;if(n!==u&&e.up(t,this.i)){var r=l(e.vals);n._n(r)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.p;t.out!==u&&0==--t.Nc&&t.out._c()},t}(),b=function(){function t(t){this.type="combine",this.insArr=t,this.out=u,this.ils=[],this.Nc=this.Nn=0,this.vals=[]}return t.prototype.up=function(t,e){var n=this.vals[e],r=this.Nn?n===u?--this.Nn:this.Nn:0;return this.vals[e]=t,0===r},t.prototype._start=function(t){this.out=t;var e=this.insArr,n=this.Nc=this.Nn=e.length,r=this.vals=new Array(n);if(0===n)t._n([]),t._c();else for(var i=0;i<n;i++)r[i]=u,e[i]._add(new g(i,t,this))},t.prototype._stop=function(){for(var t=this.insArr,e=t.length,n=this.ils,r=0;r<e;r++)t[r]._remove(n[r]);this.out=u,this.ils=[],this.vals=[]},t}(),_=function(){function t(t){this.type="fromArray",this.a=t}return t.prototype._start=function(t){for(var e=this.a,n=0,r=e.length;n<r;n++)t._n(e[n]);t._c()},t.prototype._stop=function(){},t}(),x=function(){function t(t){this.type="fromPromise",this.on=!1,this.p=t}return t.prototype._start=function(t){var e=this;this.on=!0,this.p.then((function(n){e.on&&(t._n(n),t._c())}),(function(e){t._e(e)})).then(c,(function(t){setTimeout((function(){throw t}))}))},t.prototype._stop=function(){this.on=!1},t}(),w=function(){function t(t){this.type="periodic",this.period=t,this.intervalID=-1,this.i=0}return t.prototype._start=function(t){var e=this;this.intervalID=setInterval((function(){t._n(e.i++)}),this.period)},t.prototype._stop=function(){-1!==this.intervalID&&clearInterval(this.intervalID),this.intervalID=-1,this.i=0},t}(),O=function(){function t(t,e){this.type="debug",this.ins=t,this.out=u,this.s=c,this.l="","string"==typeof e?this.l=e:"function"==typeof e&&(this.s=e)}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;if(e!==u){var n=this.s,r=this.l;if(n!==c)try{n(t)}catch(t){e._e(t)}else r?console.log(r+":",t):console.log(t);e._n(t)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),M=function(){function t(t,e){this.type="drop",this.ins=e,this.out=u,this.max=t,this.dropped=0}return t.prototype._start=function(t){this.out=t,this.dropped=0,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;e!==u&&this.dropped++>=this.max&&e._n(t)},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),E=function(){function t(t,e){this.out=t,this.op=e}return t.prototype._n=function(){this.op.end()},t.prototype._e=function(t){this.out._e(t)},t.prototype._c=function(){this.op.end()},t}(),j=function(){function t(t,e){this.type="endWhen",this.ins=e,this.out=u,this.o=t,this.oil=h}return t.prototype._start=function(t){this.out=t,this.o._add(this.oil=new E(t,this)),this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.o._remove(this.oil),this.out=u,this.oil=h},t.prototype.end=function(){var t=this.out;t!==u&&t._c()},t.prototype._n=function(t){var e=this.out;e!==u&&e._n(t)},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){this.end()},t}(),S=function(){function t(t,e){this.type="filter",this.ins=e,this.out=u,this.f=t}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;if(e!==u){var n=f(this,t,e);n!==u&&n&&e._n(t)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),k=function(){function t(t,e){this.out=t,this.op=e}return t.prototype._n=function(t){this.out._n(t)},t.prototype._e=function(t){this.out._e(t)},t.prototype._c=function(){this.op.inner=u,this.op.less()},t}(),A=function(){function t(t){this.type="flatten",this.ins=t,this.out=u,this.open=!0,this.inner=u,this.il=h}return t.prototype._start=function(t){this.out=t,this.open=!0,this.inner=u,this.il=h,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.inner!==u&&this.inner._remove(this.il),this.out=u,this.open=!0,this.inner=u,this.il=h},t.prototype.less=function(){var t=this.out;t!==u&&(this.open||this.inner!==u||t._c())},t.prototype._n=function(t){var e=this.out;if(e!==u){var n=this.inner,r=this.il;n!==u&&r!==h&&n._remove(r),(this.inner=t)._add(this.il=new k(e,this))}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){this.open=!1,this.less()},t}(),T=function(){function t(t,e,n){var r=this;this.type="fold",this.ins=n,this.out=u,this.f=function(e){return t(r.acc,e)},this.acc=this.seed=e}return t.prototype._start=function(t){this.out=t,this.acc=this.seed,t._n(this.acc),this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u,this.acc=this.seed},t.prototype._n=function(t){var e=this.out;if(e!==u){var n=f(this,t,e);n!==u&&e._n(this.acc=n)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),C=function(){function t(t){this.type="last",this.ins=t,this.out=u,this.has=!1,this.val=u}return t.prototype._start=function(t){this.out=t,this.has=!1,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u,this.val=u},t.prototype._n=function(t){this.has=!0,this.val=t},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&(this.has?(t._n(this.val),t._c()):t._e(new Error("last() failed because input stream completed")))},t}(),D=function(){function t(t,e){this.type="map",this.ins=e,this.out=u,this.f=t}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;if(e!==u){var n=f(this,t,e);n!==u&&e._n(n)}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),P=function(){function t(t){this.type="remember",this.ins=t,this.out=u}return t.prototype._start=function(t){this.out=t,this.ins._add(t)},t.prototype._stop=function(){this.ins._remove(this.out),this.out=u},t}(),N=function(){function t(t,e){this.type="replaceError",this.ins=e,this.out=u,this.f=t}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;e!==u&&e._n(t)},t.prototype._e=function(t){var e=this.out;if(e!==u)try{this.ins._remove(this),(this.ins=this.f(t))._add(this)}catch(t){e._e(t)}},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),I=function(){function t(t,e){this.type="startWith",this.ins=t,this.out=u,this.val=e}return t.prototype._start=function(t){this.out=t,this.out._n(this.val),this.ins._add(t)},t.prototype._stop=function(){this.ins._remove(this.out),this.out=u},t}(),L=function(){function t(t,e){this.type="take",this.ins=e,this.out=u,this.max=t,this.taken=0}return t.prototype._start=function(t){this.out=t,this.taken=0,this.max<=0?t._c():this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=u},t.prototype._n=function(t){var e=this.out;if(e!==u){var n=++this.taken;n<this.max?e._n(t):n===this.max&&(e._n(t),e._c())}},t.prototype._e=function(t){var e=this.out;e!==u&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==u&&t._c()},t}(),B=function(){function t(t){this._prod=t||u,this._ils=[],this._stopID=u,this._dl=u,this._d=!1,this._target=null,this._err=u}return t.prototype._n=function(t){var e=this._ils,n=e.length;if(this._d&&this._dl._n(t),1==n)e[0]._n(t);else{if(0==n)return;for(var r=l(e),i=0;i<n;i++)r[i]._n(t)}},t.prototype._e=function(t){if(this._err===u){this._err=t;var e=this._ils,n=e.length;if(this._x(),this._d&&this._dl._e(t),1==n)e[0]._e(t);else{if(0==n)return;for(var r=l(e),i=0;i<n;i++)r[i]._e(t)}if(!this._d&&0==n)throw this._err}},t.prototype._c=function(){var t=this._ils,e=t.length;if(this._x(),this._d&&this._dl._c(),1==e)t[0]._c();else{if(0==e)return;for(var n=l(t),r=0;r<e;r++)n[r]._c()}},t.prototype._x=function(){0!==this._ils.length&&(this._prod!==u&&this._prod._stop(),this._err=u,this._ils=[])},t.prototype._stopNow=function(){this._prod._stop(),this._err=u,this._stopID=u},t.prototype._add=function(t){var e=this._target;if(e)return e._add(t);var n=this._ils;if(n.push(t),!(n.length>1))if(this._stopID!==u)clearTimeout(this._stopID),this._stopID=u;else{var r=this._prod;r!==u&&r._start(this)}},t.prototype._remove=function(t){var e=this,n=this._target;if(n)return n._remove(t);var r=this._ils,i=r.indexOf(t);i>-1&&(r.splice(i,1),this._prod!==u&&r.length<=0?(this._err=u,this._stopID=setTimeout((function(){return e._stopNow()}))):1===r.length&&this._pruneCycles())},t.prototype._pruneCycles=function(){this._hasNoSinks(this,[])&&this._remove(this._ils[0])},t.prototype._hasNoSinks=function(t,e){if(-1!==e.indexOf(t))return!0;if(t.out===this)return!0;if(t.out&&t.out!==u)return this._hasNoSinks(t.out,e.concat(t));if(t._ils){for(var n=0,r=t._ils.length;n<r;n++)if(!this._hasNoSinks(t._ils[n],e.concat(t)))return!1;return!0}return!1},t.prototype.ctor=function(){return this instanceof R?R:t},t.prototype.addListener=function(t){t._n=t.next||c,t._e=t.error||c,t._c=t.complete||c,this._add(t)},t.prototype.removeListener=function(t){this._remove(t)},t.prototype.subscribe=function(t){return this.addListener(t),new d(this,t)},t.prototype[a]=function(){return this},t.create=function(e){if(e){if("function"!=typeof e.start||"function"!=typeof e.stop)throw new Error("producer requires both start and stop functions");p(e)}return new t(e)},t.createWithMemory=function(t){return t&&p(t),new R(t)},t.never=function(){return new t({_start:c,_stop:c})},t.empty=function(){return new t({_start:function(t){t._c()},_stop:c})},t.throw=function(e){return new t({_start:function(t){t._e(e)},_stop:c})},t.from=function(e){if("function"==typeof e[a])return t.fromObservable(e);if("function"==typeof e.then)return t.fromPromise(e);if(Array.isArray(e))return t.fromArray(e);throw new TypeError("Type of input to from() must be an Array, Promise, or Observable")},t.of=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.fromArray(e)},t.fromArray=function(e){return new t(new _(e))},t.fromPromise=function(e){return new t(new x(e))},t.fromObservable=function(e){if(void 0!==e.endWhen)return e;var n="function"==typeof e[a]?e[a]():e;return new t(new y(n))},t.periodic=function(e){return new t(new w(e))},t.prototype._map=function(t){return new(this.ctor())(new D(t,this))},t.prototype.map=function(t){return this._map(t)},t.prototype.mapTo=function(t){var e=this.map((function(){return t}));return e._prod.type="mapTo",e},t.prototype.filter=function(e){var n,r,i=this._prod;return new t(i instanceof S?new S((n=i.f,r=e,function(t){return n(t)&&r(t)}),i.ins):new S(e,this))},t.prototype.take=function(t){return new(this.ctor())(new L(t,this))},t.prototype.drop=function(e){return new t(new M(e,this))},t.prototype.last=function(){return new t(new C(this))},t.prototype.startWith=function(t){return new R(new I(this,t))},t.prototype.endWhen=function(t){return new(this.ctor())(new j(t,this))},t.prototype.fold=function(t,e){return new R(new T(t,e,this))},t.prototype.replaceError=function(t){return new(this.ctor())(new N(t,this))},t.prototype.flatten=function(){return new t(new A(this))},t.prototype.compose=function(t){return t(this)},t.prototype.remember=function(){return new R(new P(this))},t.prototype.debug=function(t){return new(this.ctor())(new O(this,t))},t.prototype.imitate=function(t){if(t instanceof R)throw new Error("A MemoryStream was given to imitate(), but it only supports a Stream. Read more about this restriction here: https://github.com/staltz/xstream#faq");this._target=t;for(var e=this._ils,n=e.length,r=0;r<n;r++)t._add(e[r]);this._ils=[]},t.prototype.shamefullySendNext=function(t){this._n(t)},t.prototype.shamefullySendError=function(t){this._e(t)},t.prototype.shamefullySendComplete=function(){this._c()},t.prototype.setDebugListener=function(t){t?(this._d=!0,t._n=t.next||c,t._e=t.error||c,t._c=t.complete||c,this._dl=t):(this._d=!1,this._dl=u)},t.merge=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new t(new v(e))},t.combine=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new t(new b(e))},t}();e.Stream=B;var R=function(t){function e(e){var n=t.call(this,e)||this;return n._has=!1,n}return i(e,t),e.prototype._n=function(e){this._v=e,this._has=!0,t.prototype._n.call(this,e)},e.prototype._add=function(t){var e=this._target;if(e)return e._add(t);var n=this._ils;if(n.push(t),n.length>1)this._has&&t._n(this._v);else if(this._stopID!==u)this._has&&t._n(this._v),clearTimeout(this._stopID),this._stopID=u;else if(this._has)t._n(this._v);else{var r=this._prod;r!==u&&r._start(this)}},e.prototype._stopNow=function(){this._has=!1,t.prototype._stopNow.call(this)},e.prototype._x=function(){this._has=!1,t.prototype._x.call(this)},e.prototype.map=function(t){return this._map(t)},e.prototype.mapTo=function(e){return t.prototype.mapTo.call(this,e)},e.prototype.take=function(e){return t.prototype.take.call(this,e)},e.prototype.endWhen=function(e){return t.prototype.endWhen.call(this,e)},e.prototype.replaceError=function(e){return t.prototype.replaceError.call(this,e)},e.prototype.remember=function(){return this},e.prototype.debug=function(e){return t.prototype.debug.call(this,e)},e}(B);e.MemoryStream=R;var $=B;e.default=$},function(e,n){e.exports=t},function(t,e,n){"use strict";(function(t){function n(){var e;return(e="undefined"!=typeof window?window:void 0!==t?t:this).Cyclejs=e.Cyclejs||{},(e=e.Cyclejs).adaptStream=e.adaptStream||function(t){return t},e}Object.defineProperty(e,"__esModule",{value:!0}),e.setAdapt=function(t){n().adaptStream=t},e.adapt=function(t){return n().adaptStream(t)}}).call(this,n(4))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),i=n(34);function o(t,e,n){var o,s,a,u={};if(void 0!==n?(u=e,i.array(n)?o=n:i.primitive(n)?s=n:n&&n.sel&&(o=[n])):void 0!==e&&(i.array(e)?o=e:i.primitive(e)?s=e:e&&e.sel?o=[e]:u=e),void 0!==o)for(a=0;a<o.length;++a)i.primitive(o[a])&&(o[a]=r.vnode(void 0,void 0,void 0,o[a],void 0));return"s"!==t[0]||"v"!==t[1]||"g"!==t[2]||3!==t.length&&"."!==t[3]&&"#"!==t[3]||function t(e,n,r){if(e.ns="http://www.w3.org/2000/svg","foreignObject"!==r&&void 0!==n)for(var i=0;i<n.length;++i){var o=n[i].data;void 0!==o&&t(o,n[i].children,n[i].sel)}}(u,o,t),r.vnode(t,u,o,s,void 0)}e.h=o,e.default=o},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){var n,r=("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:Function("return this")()).Symbol;n="function"==typeof r?r("parent"):"@@snabbdom-selector-parent",e.a=n}).call(this,n(4))},function(t,e,n){"use strict";function r(t,e,n,r,i){return{sel:t,data:e,children:n,text:r,elm:i,key:void 0===e?void 0:e.key}}Object.defineProperty(e,"__esModule",{value:!0}),e.vnode=r,e.default=r},function(t,e,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};Object.defineProperty(e,"__esModule",{value:!0}),e.SampleCombineOperator=e.SampleCombineListener=void 0;var i=n(0),o={},s=function(){function t(t,e){this.i=t,this.p=e,e.ils[t]=this}return t.prototype._n=function(t){var e=this.p;e.out!==o&&e.up(t,this.i)},t.prototype._e=function(t){this.p._e(t)},t.prototype._c=function(){this.p.down(this.i,this)},t}();e.SampleCombineListener=s;var a,u=function(){function t(t,e){this.type="sampleCombine",this.ins=t,this.others=e,this.out=o,this.ils=[],this.Nn=0,this.vals=[]}return t.prototype._start=function(t){this.out=t;for(var e=this.others,n=this.Nn=e.length,r=this.vals=new Array(n),i=0;i<n;i++)r[i]=o,e[i]._add(new s(i,this));this.ins._add(this)},t.prototype._stop=function(){var t=this.others,e=t.length,n=this.ils;this.ins._remove(this);for(var r=0;r<e;r++)t[r]._remove(n[r]);this.out=o,this.vals=[],this.ils=[]},t.prototype._n=function(t){var e=this.out;e!==o&&(this.Nn>0||e._n(r([t],this.vals)))},t.prototype._e=function(t){var e=this.out;e!==o&&e._e(t)},t.prototype._c=function(){var t=this.out;t!==o&&t._c()},t.prototype.up=function(t,e){var n=this.vals[e];this.Nn>0&&n===o&&this.Nn--,this.vals[e]=t},t.prototype.down=function(t,e){this.others[t]._remove(e)},t}();e.SampleCombineOperator=u,a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return new i.Stream(new u(e,t))}},e.default=a},function(t,e,n){"use strict";function r(t,e){var n,r,i=e.elm,o=t.data.class,s=e.data.class;if((o||s)&&o!==s){for(r in s=s||{},o=o||{})s[r]||i.classList.remove(r);for(r in s)(n=s[r])!==o[r]&&i.classList[n?"add":"remove"](r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.classModule={create:r,update:r},e.default=e.classModule},function(t,e,n){"use strict";function r(t,e){var n,r,i=e.elm,o=t.data.props,s=e.data.props;if((o||s)&&o!==s){for(n in s=s||{},o=o||{})s[n]||delete i[n];for(n in s)r=s[n],o[n]===r||"value"===n&&i[n]===r||(i[n]=r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.propsModule={create:r,update:r},e.default=e.propsModule},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function r(t,e){var n,r=e.elm,i=t.data.attrs,o=e.data.attrs;if((i||o)&&i!==o){for(n in i=i||{},o=o||{}){var s=o[n];i[n]!==s&&(!0===s?r.setAttribute(n,""):!1===s?r.removeAttribute(n):120!==n.charCodeAt(0)?r.setAttribute(n,s):58===n.charCodeAt(3)?r.setAttributeNS("http://www.w3.org/XML/1998/namespace",n,s):58===n.charCodeAt(5)?r.setAttributeNS("http://www.w3.org/1999/xlink",n,s):r.setAttribute(n,s))}for(n in i)n in o||r.removeAttribute(n)}}e.attributesModule={create:r,update:r},e.default=e.attributesModule},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="undefined"!=typeof window&&window.requestAnimationFrame.bind(window)||setTimeout,i=!1;function o(t,e,n){var i;i=function(){t[e]=n},r((function(){r(i)}))}function s(t,e){var n,r,i=e.elm,s=t.data.style,a=e.data.style;if((s||a)&&s!==a){a=a||{};var u="delayed"in(s=s||{});for(r in s)a[r]||("-"===r[0]&&"-"===r[1]?i.style.removeProperty(r):i.style[r]="");for(r in a)if(n=a[r],"delayed"===r&&a.delayed)for(var c in a.delayed)n=a.delayed[c],u&&n===s.delayed[c]||o(i.style,c,n);else"remove"!==r&&n!==s[r]&&("-"===r[0]&&"-"===r[1]?i.style.setProperty(r,n):i.style[r]=n)}}e.styleModule={pre:function(){i=!1},create:s,update:s,destroy:function(t){var e,n,r=t.elm,i=t.data.style;if(i&&(e=i.destroy))for(n in e)r.style[n]=e[n]},remove:function(t,e){var n=t.data.style;if(n&&n.remove){i||(t.elm.offsetLeft,i=!0);var r,o=t.elm,s=0,a=n.remove,u=0,c=[];for(r in a)c.push(r),o.style[r]=a[r];for(var l=getComputedStyle(o)["transition-property"].split(", ");s<l.length;++s)-1!==c.indexOf(l[s])&&u++;o.addEventListener("transitionend",(function(t){t.target===o&&--u,0===u&&e()}))}else e()}},e.default=e.styleModule},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=/[A-Z]/g;function i(t,e){var n,i=e.elm,o=t.data.dataset,s=e.data.dataset;if((o||s)&&o!==s){o=o||{},s=s||{};var a=i.dataset;for(n in o)s[n]||(a?n in a&&delete a[n]:i.removeAttribute("data-"+n.replace(r,"-$&").toLowerCase()));for(n in s)o[n]!==s[n]&&(a?a[n]=s[n]:i.setAttribute("data-"+n.replace(r,"-$&").toLowerCase(),s[n]))}}e.datasetModule={create:i,update:i},e.default=e.datasetModule},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t){this.ins=t,this.type="pairwise",this.val=null,this.has=!1,this.out=null}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.has=!1,this.out=null,this.val=null},t.prototype._n=function(t){var e=this.out;if(e)if(this.has){var n=this.val;this.val=t,e._n([n,t])}else this.val=t,this.has=!0},t.prototype._e=function(t){var e=this.out;e&&e._e(t)},t.prototype._c=function(){var t=this.out;t&&t._c()},t}();e.default=function(t){return new r.Stream(new i(t))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),i=n(35);function o(t,e){var n,s=void 0!==e?e:i.default;if(s.isElement(t)){var a,u=t.id?"#"+t.id:"",c=t.getAttribute("class"),l=c?"."+c.split(" ").join("."):"",f=s.tagName(t).toLowerCase()+u+l,h={},p=[],d=void 0,m=void 0,y=t.attributes,v=t.childNodes;for(d=0,m=y.length;d<m;d++)"id"!==(a=y[d].nodeName)&&"class"!==a&&(h[a]=y[d].nodeValue);for(d=0,m=v.length;d<m;d++)p.push(o(v[d],e));return r.default(f,{attrs:h},p,void 0,t)}return s.isText(t)?(n=s.getTextContent(t),r.default(void 0,void 0,void 0,n,t)):s.isComment(t)?(n=s.getTextContent(t),r.default("!",{},[],n,t)):r.default("",{},[],void 0,t)}e.toVNode=o,e.default=o},function(t,e,n){"use strict";var r=n(29),i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,s=Array.prototype.concat,a=Object.defineProperty,u=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),c=function(t,e,n,r){var i;(!(e in t)||"function"==typeof(i=r)&&"[object Function]"===o.call(i)&&r())&&(u?a(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},l=function(t,e){var n=arguments.length>2?arguments[2]:{},o=r(e);i&&(o=s.call(o,Object.getOwnPropertySymbols(e)));for(var a=0;a<o.length;a+=1)c(t,o[a],e[o[a]],n[o[a]])};l.supportsDescriptors=!!u,t.exports=l},function(t,e,n){"use strict";var r=Object.prototype.toString;t.exports=function(t){var e=r.call(t),n="[object Arguments]"===e;return n||(n="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===r.call(t.callee)),n}},function(t,e,n){"use strict";"undefined"!=typeof self?t.exports=self:"undefined"!=typeof window?t.exports=window:t.exports=Function("return this")()},function(t,e,n){"use strict";(function(e){var r=n(17);t.exports=function(){return"object"==typeof e&&e&&e.Math===Math&&e.Array===Array?e:r}}).call(this,n(4))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&p())}function p(){if(!l){var t=a(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||l||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if("undefined"!=typeof MutationObserver){var e=document.createTextNode(""),r=[],i=0;return new MutationObserver((function(){for(;r.length;)r.shift()()})).observe(e,{characterData:!0}),function(t){r.push(t),e.data=i=1-i}}return void 0!==t?t:void 0!==n?n.nextTick:setTimeout}}).call(this,n(32).setImmediate,n(19))},function(t,e,n){"use strict";(function(t){function r(){var e;return(e="undefined"!=typeof window?window:void 0!==t?t:this).Cyclejs=e.Cyclejs||{},(e=e.Cyclejs).adaptStream=e.adaptStream||function(t){return t},e}function i(t){return r().adaptStream(t)}n.d(e,"a",(function(){return i}))}).call(this,n(4))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t){this.streams=t,this.type="concat",this.out=null,this.i=0}return t.prototype._start=function(t){this.out=t,this.streams[this.i]._add(this)},t.prototype._stop=function(){var t=this.streams;this.i<t.length&&t[this.i]._remove(this),this.i=0,this.out=null},t.prototype._n=function(t){var e=this.out;e&&e._n(t)},t.prototype._e=function(t){var e=this.out;e&&e._e(t)},t.prototype._c=function(){var t=this.out;if(t){var e=this.streams;e[this.i]._remove(this),++this.i<e.length?e[this.i]._add(this):t._c()}},t}();e.default=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new r.Stream(new i(t))}},function(t,e,n){"use strict";var r=n(24),i=n.n(r)()((function(t){return t[1]}));i.push([t.i,"#beholder-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 100;\n}\n\n/* #detection-panel {\n  position: absolute;\n  top: 0;\n  left: 10vw;\n  transition: all 500ms ease-in-out;\n  z-index: 999;\n}\n\n#detection-panel.active {\n  top: 0;\n  left: 0;\n} */\n\n#detection-panel #detection-canvas {\n  position: relative;\n  float: left;\n  clear: both;\n  border-radius: 0 0 0.5em 0;\n  border-bottom: 4px solid #FFF;\n}\n\n#detection-panel #detection-canvas-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  border-radius: 0 0 0.5em 0;\n}\n\n#detection-panel #parameters-menu {\n  position: relative;\n  float: left;\n  clear: both;\n  margin: 1em 0 1em 0em;\n  padding: 1em 1.5em 1em 1.5em;\n  background: black;\n  border-radius: 0 0.5em 0.5em 0;\n  border-bottom: 4px solid #FFF;\n}\n\n#detection-panel #parameters-menu .parameter-item {\n  position: relative;\n  float: left;\n  clear: both;\n  margin: 0.25em 0 0.25em 0;\n}\n\n#detection-panel #parameters-menu .parameter-item span {\n  position: relative;\n  float: left;\n  width: 18em;\n  font-weight: 600;\n  color: white;\n}\n\n#toggle-screen {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 50px;\n  height: 50px;\n  background: #000;\n  z-index: 9999;\n  color: white;\n  font-size: 20px;\n  font-weight: 700;\n  padding: 6px;\n  border-radius: 0 0 50px 0;\n  box-sizing: border-box;\n  cursor: pointer;\n  transition: all 100ms ease-in;\n}\n\n#toggle-screen:hover, #toggle-screen:active {\n  padding: 6px 0 0 0;\n}\n\n#beholder-video {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: -1;\n}",""]),e.a=i},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var a=0;a<t.length;a++){var u=[].concat(t[a]);r&&i[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),e.push(u))}},e}},,function(t,e,n){t.exports=n(27)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n=t.Symbol;if("function"==typeof n)if(n.observable)e=n.observable;else{e=n.for("https://github.com/benlesh/symbol-observable");try{n.observable=e}catch(t){}}else e="@@observable";return e}},function(t,e,n){"use strict";var r=n(15),i=n(17),o=n(18),s=n(31),a=o(),u=function(){return a};r(u,{getPolyfill:o,implementation:i,shim:s}),t.exports=u},function(t,e,n){"use strict";var r=Array.prototype.slice,i=n(16),o=Object.keys,s=o?function(t){return o(t)}:n(30),a=Object.keys;s.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return i(t)?a(r.call(t)):a(t)}):Object.keys=s;return Object.keys||s},t.exports=s},function(t,e,n){"use strict";var r;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=n(16),a=Object.prototype.propertyIsEnumerable,u=!a.call({toString:null},"toString"),c=a.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(t){var e=t.constructor;return e&&e.prototype===t},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!h["$"+t]&&i.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{f(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();r=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===o.call(t),r=s(t),a=e&&"[object String]"===o.call(t),h=[];if(!e&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var d=c&&n;if(a&&t.length>0&&!i.call(t,0))for(var m=0;m<t.length;++m)h.push(String(m));if(r&&t.length>0)for(var y=0;y<t.length;++y)h.push(String(y));else for(var v in t)d&&"prototype"===v||!i.call(t,v)||h.push(String(v));if(u)for(var g=function(t){if("undefined"==typeof window||!p)return f(t);try{return f(t)}catch(t){return!1}}(t),b=0;b<l.length;++b)g&&"constructor"===l[b]||!i.call(t,l[b])||h.push(l[b]);return h}}t.exports=r},function(t,e,n){"use strict";var r=n(15),i=n(18);t.exports=function(){var t=i();if(r.supportsDescriptors){var e=Object.getOwnPropertyDescriptor(t,"globalThis");(!e||e.configurable&&(e.enumerable||e.writable||globalThis!==t))&&Object.defineProperty(t,"globalThis",{configurable:!0,enumerable:!1,value:t,writable:!1})}else"object"==typeof globalThis&&globalThis===t||(t.globalThis=t);return t}},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(33),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(4))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,s,a,u=1,c={},l=!1,f=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){d(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},r=function(t){o.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(i=f.documentElement,r=function(t){var e=f.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(d,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&d(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(s+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},h.clearImmediate=p}function p(t){delete c[t]}function d(t){if(l)setTimeout(d,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{p(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(4),n(19))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.array=Array.isArray,e.primitive=function(t){return"string"==typeof t||"number"==typeof t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.htmlDomApi={createElement:function(t){return document.createElement(t)},createElementNS:function(t,e){return document.createElementNS(t,e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,n){t.insertBefore(e,n)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},getTextContent:function(t){return t.textContent},isElement:function(t){return 1===t.nodeType},isText:function(t){return 3===t.nodeType},isComment:function(t){return 8===t.nodeType}},e.default=e.htmlDomApi},function(t,e,n){"use strict";n.r(e),n.d(e,"update",(function(){return Fe})),n.d(e,"init",(function(){return qe})),n.d(e,"getAllMarkers",(function(){return Ve})),n.d(e,"getMarker",(function(){return He})),n.d(e,"getMarkerPair",(function(){return Xe}));var r=n(0),i=n.n(r),o=n(13),s=n.n(o),a=n(20),u=n.n(a),c=n(21);function l(t){return 0===Object.keys(t).length}function f(t,e){if("function"!=typeof t)throw new Error("First argument given to Cycle must be the 'main' function.");if("object"!=typeof e||null===e)throw new Error("Second argument given to Cycle must be an object with driver functions as properties.");if(l(e))throw new Error("Second argument given to Cycle must be an object with at least one driver function declared as a property.");var n=function(t){if("object"!=typeof t||null===t)throw new Error("Argument given to setupReusable must be an object with driver functions as properties.");if(l(t))throw new Error("Argument given to setupReusable must be an object with at least one driver function declared as a property.");var e=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=i.a.create());return e}(t),n=function(t){for(var e in t)t.hasOwnProperty(e)&&t[e]&&"function"==typeof t[e].shamefullySendNext&&(t[e]=Object(c.a)(t[e]));return t}(function(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r](e[r],r),n[r]&&"object"==typeof n[r]&&(n[r]._isCycleSource=r));return n}(t,e));return{sources:n,run:function(t){return function(t,e){var n=u()(),r=Object.keys(t).filter((function(t){return!!e[t]})),o={},s={};r.forEach((function(t){o[t]={_n:[],_e:[]},s[t]={next:function(e){return o[t]._n.push(e)},error:function(e){return o[t]._e.push(e)},complete:function(){}}}));var a=r.map((function(e){return i.a.fromObservable(t[e]).subscribe(s[e])}));return r.forEach((function(t){var r=e[t],i=function(t){n((function(){return r._n(t)}))},a=function(t){n((function(){(console.error||console.log)(t),r._e(t)}))};o[t]._n.forEach(i),o[t]._e.forEach(a),s[t].next=i,s[t].error=a,s[t]._n=i,s[t]._e=a})),o=null,function(){a.forEach((function(t){return t.unsubscribe()}))}}(t,e)},dispose:function(){!function(t){for(var e in t)t.hasOwnProperty(e)&&t[e]&&t[e].dispose&&t[e].dispose()}(n),function(t){Object.keys(t).forEach((function(e){return t[e]._c()}))}(e)}}}(e),r=t(n.sources);return"undefined"!=typeof window&&(window.Cyclejs=window.Cyclejs||{},window.Cyclejs.sinks=r),{sinks:r,sources:n.sources,run:function(){var t=n.run(r);return function(){t(),n.dispose()}}}}function h(t,e){var n=f(t,e);return"undefined"!=typeof window&&window.CyclejsDevTool_startGraphSerializer&&window.CyclejsDevTool_startGraphSerializer(n.sinks),n.run()}var p=n(3);var d=n(2);function m(t,e,n,i,o){void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===o&&(o=!1);var s=null;return r.Stream.create({start:function(r){s=i?function(t){y(t,i),r.next(t)}:function(t){r.next(t)},t.addEventListener(e,s,{capture:n,passive:o})},stop:function(){t.removeEventListener(e,s,n),s=null}})}function y(t,e){if(e)if("boolean"==typeof e)t.preventDefault();else if("function"==typeof e)e(t)&&t.preventDefault();else{if("object"!=typeof e)throw new Error("preventDefault has to be either a boolean, predicate function or object");(function t(e,n){for(var r=Object.keys(e),i=r.length,o=0;o<i;o++){var s=r[o];if("object"==typeof e[s]&&"object"==typeof n[s]){if(!t(e[s],n[s]))return!1}else if(e[s]!==n[s])return!1}return!0})(e,t)&&t.preventDefault()}}var v=function(){function t(t){this._name=t}return t.prototype.select=function(t){return this},t.prototype.elements=function(){var t=Object(d.adapt)(i.a.of([document]));return t._isCycleSource=this._name,t},t.prototype.element=function(){var t=Object(d.adapt)(i.a.of(document));return t._isCycleSource=this._name,t},t.prototype.events=function(t,e,n){var r;void 0===e&&(e={}),r=m(document,t,e.useCapture,e.preventDefault);var i=Object(d.adapt)(r);return i._isCycleSource=this._name,i},t}(),g=function(){function t(t){this._name=t}return t.prototype.select=function(t){return this},t.prototype.elements=function(){var t=Object(d.adapt)(i.a.of([document.body]));return t._isCycleSource=this._name,t},t.prototype.element=function(){var t=Object(d.adapt)(i.a.of(document.body));return t._isCycleSource=this._name,t},t.prototype.events=function(t,e,n){var r;void 0===e&&(e={}),r=m(document.body,t,e.useCapture,e.preventDefault);var i=Object(d.adapt)(r);return i._isCycleSource=this._name,i},t}();function b(t){if("string"!=typeof t&&(e=t,!("object"==typeof HTMLElement?e instanceof HTMLElement||e instanceof DocumentFragment:e&&"object"==typeof e&&null!==e&&(1===e.nodeType||11===e.nodeType)&&"string"==typeof e.nodeName)))throw new Error("Given container is not a DOM element neither a selector string.");var e}function _(t){for(var e="",n=t.length-1;n>=0&&"selector"===t[n].type;n--)e=t[n].scope+" "+e;return e.trim()}function x(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].type!==e[n].type||t[n].scope!==e[n].scope)return!1;return!0}var w=function(){function t(t,e){this.namespace=t,this.isolateModule=e,this._namespace=t.filter((function(t){return"selector"!==t.type}))}return t.prototype.isDirectlyInScope=function(t){var e=this.isolateModule.getNamespace(t);if(!e)return!1;if(this._namespace.length>e.length||!x(this._namespace,e.slice(0,this._namespace.length)))return!1;for(var n=this._namespace.length;n<e.length;n++)if("total"===e[n].type)return!1;return!0},t}();var O=function(){function t(t,e){this.namespace=t,this.isolateModule=e}return t.prototype.call=function(){var t,e=this.namespace,n=_(e),r=new w(e,this.isolateModule),i=this.isolateModule.getElement(e.filter((function(t){return"selector"!==t.type})));return void 0===i?[]:""===n?[i]:(t=i.querySelectorAll(n),Array.prototype.slice.call(t)).filter(r.isDirectlyInScope,r).concat(i.matches(n)?[i]:[])},t}(),M=function(){return(M=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function E(t){return{type:(e=t,e.length>1&&("."===e[0]||"#"===e[0])?"sibling":"total"),scope:t};var e}var j=function(){function t(e,n,r,i,o,s){var a;void 0===r&&(r=[]),this._rootElement$=e,this._sanitation$=n,this._namespace=r,this._isolateModule=i,this._eventDelegator=o,this._name=s,this.isolateSource=function(e,n){return new t(e._rootElement$,e._sanitation$,e._namespace.concat(E(n)),e._isolateModule,e._eventDelegator,e._name)},this.isolateSink=(a=this._namespace,function(t,e){return":root"===e?t:t.map((function(t){if(!t)return t;var n=E(e),r=M({},t,{data:M({},t.data,{isolate:t.data&&Array.isArray(t.data.isolate)?t.data.isolate:a.concat([n])})});return M({},r,{key:void 0!==r.key?r.key:JSON.stringify(r.data.isolate)})}))})}return t.prototype._elements=function(){if(0===this._namespace.length)return this._rootElement$.map((function(t){return[t]}));var t=new O(this._namespace,this._isolateModule);return this._rootElement$.map((function(){return t.call()}))},t.prototype.elements=function(){var t=Object(d.adapt)(this._elements().remember());return t._isCycleSource=this._name,t},t.prototype.element=function(){var t=Object(d.adapt)(this._elements().filter((function(t){return t.length>0})).map((function(t){return t[0]})).remember());return t._isCycleSource=this._name,t},Object.defineProperty(t.prototype,"namespace",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),t.prototype.select=function(e){if("string"!=typeof e)throw new Error("DOM driver's select() expects the argument to be a string as a CSS selector");if("document"===e)return new v(this._name);if("body"===e)return new g(this._name);var n=":root"===e?[]:this._namespace.concat({type:"selector",scope:e.trim()});return new t(this._rootElement$,this._sanitation$,n,this._isolateModule,this._eventDelegator,this._name)},t.prototype.events=function(t,e,n){if(void 0===e&&(e={}),"string"!=typeof t)throw new Error("DOM driver's events() expects argument to be a string representing the event type to listen for.");var r=this._eventDelegator.addEventListener(t,this._namespace,e,n),i=Object(d.adapt)(r);return i._isCycleSource=this._name,i},t.prototype.dispose=function(){this._sanitation$.shamefullySendNext(null)},t}();function S(t,e,n,r,i){return{sel:t,data:e,children:n,text:r,elm:i,key:void 0===e?void 0:e.key}}var k=S,A=Array.isArray;function T(t){return"string"==typeof t||"number"==typeof t}var C={createElement:function(t){return document.createElement(t)},createElementNS:function(t,e){return document.createElementNS(t,e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,n){t.insertBefore(e,n)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},getTextContent:function(t){return t.textContent},isElement:function(t){return 1===t.nodeType},isText:function(t){return 3===t.nodeType},isComment:function(t){return 8===t.nodeType}};function D(t){return void 0===t}function P(t){return void 0!==t}var N=k("",{},[],void 0,void 0);function I(t,e){return t.key===e.key&&t.sel===e.sel}function L(t,e,n){var r,i,o,s={};for(r=e;r<=n;++r)null!=(o=t[r])&&void 0!==(i=o.key)&&(s[i]=r);return s}var B=["create","update","remove","destroy","pre","post"];function R(t,e){var n,r,i={},o=void 0!==e?e:C;for(n=0;n<B.length;++n)for(i[B[n]]=[],r=0;r<t.length;++r){var s=t[r][B[n]];void 0!==s&&i[B[n]].push(s)}function a(t,e){return function(){if(0==--e){var n=o.parentNode(t);o.removeChild(n,t)}}}function u(t,e){var n,r=t.data;void 0!==r&&P(n=r.hook)&&P(n=n.init)&&(n(t),r=t.data);var s=t.children,a=t.sel;if("!"===a)D(t.text)&&(t.text=""),t.elm=o.createComment(t.text);else if(void 0!==a){var c=a.indexOf("#"),l=a.indexOf(".",c),f=c>0?c:a.length,h=l>0?l:a.length,p=-1!==c||-1!==l?a.slice(0,Math.min(f,h)):a,d=t.elm=P(r)&&P(n=r.ns)?o.createElementNS(n,p):o.createElement(p);for(f<h&&d.setAttribute("id",a.slice(f+1,h)),l>0&&d.setAttribute("class",a.slice(h+1).replace(/\./g," ")),n=0;n<i.create.length;++n)i.create[n](N,t);if(A(s))for(n=0;n<s.length;++n){var m=s[n];null!=m&&o.appendChild(d,u(m,e))}else T(t.text)&&o.appendChild(d,o.createTextNode(t.text));P(n=t.data.hook)&&(n.create&&n.create(N,t),n.insert&&e.push(t))}else t.elm=o.createTextNode(t.text);return t.elm}function c(t,e,n,r,i,s){for(;r<=i;++r){var a=n[r];null!=a&&o.insertBefore(t,u(a,s),e)}}function l(t){var e,n,r=t.data;if(void 0!==r){for(P(e=r.hook)&&P(e=e.destroy)&&e(t),e=0;e<i.destroy.length;++e)i.destroy[e](t);if(void 0!==t.children)for(n=0;n<t.children.length;++n)null!=(e=t.children[n])&&"string"!=typeof e&&l(e)}}function f(t,e,n,r){for(;n<=r;++n){var s=void 0,u=void 0,c=void 0,f=e[n];if(null!=f)if(P(f.sel)){for(l(f),u=i.remove.length+1,c=a(f.elm,u),s=0;s<i.remove.length;++s)i.remove[s](f,c);P(s=f.data)&&P(s=s.hook)&&P(s=s.remove)?s(f,c):c()}else o.removeChild(t,f.elm)}}function h(t,e,n){var r,s;P(r=e.data)&&P(s=r.hook)&&P(r=s.prepatch)&&r(t,e);var a=e.elm=t.elm,l=t.children,p=e.children;if(t!==e){if(void 0!==e.data){for(r=0;r<i.update.length;++r)i.update[r](t,e);P(r=e.data.hook)&&P(r=r.update)&&r(t,e)}D(e.text)?P(l)&&P(p)?l!==p&&function(t,e,n,r){for(var i,s,a,l=0,p=0,d=e.length-1,m=e[0],y=e[d],v=n.length-1,g=n[0],b=n[v];l<=d&&p<=v;)null==m?m=e[++l]:null==y?y=e[--d]:null==g?g=n[++p]:null==b?b=n[--v]:I(m,g)?(h(m,g,r),m=e[++l],g=n[++p]):I(y,b)?(h(y,b,r),y=e[--d],b=n[--v]):I(m,b)?(h(m,b,r),o.insertBefore(t,m.elm,o.nextSibling(y.elm)),m=e[++l],b=n[--v]):I(y,g)?(h(y,g,r),o.insertBefore(t,y.elm,m.elm),y=e[--d],g=n[++p]):(void 0===i&&(i=L(e,l,d)),D(s=i[g.key])?(o.insertBefore(t,u(g,r),m.elm),g=n[++p]):((a=e[s]).sel!==g.sel?o.insertBefore(t,u(g,r),m.elm):(h(a,g,r),e[s]=void 0,o.insertBefore(t,a.elm,m.elm)),g=n[++p]));(l<=d||p<=v)&&(l>d?c(t,null==n[v+1]?null:n[v+1].elm,n,p,v,r):f(t,e,l,d))}(a,l,p,n):P(p)?(P(t.text)&&o.setTextContent(a,""),c(a,null,p,0,p.length-1,n)):P(l)?f(a,l,0,l.length-1):P(t.text)&&o.setTextContent(a,""):t.text!==e.text&&(P(l)&&f(a,l,0,l.length-1),o.setTextContent(a,e.text)),P(s)&&P(r=s.postpatch)&&r(t,e)}}return function(t,e){var n,r,s,a=[];for(n=0;n<i.pre.length;++n)i.pre[n]();for(function(t){return void 0!==t.sel}(t)||(t=function(t){var e=t.id?"#"+t.id:"",n=t.className?"."+t.className.split(" ").join("."):"";return k(o.tagName(t).toLowerCase()+e+n,{},[],void 0,t)}(t)),I(t,e)?h(t,e,a):(r=t.elm,s=o.parentNode(r),u(e,a),null!==s&&(o.insertBefore(s,e.elm,o.nextSibling(r)),f(s,[t],0,0))),n=0;n<a.length;++n)a[n].data.hook.insert(a[n]);for(n=0;n<i.post.length;++n)i.post[n]();return e}}var $=n(22),F=n.n($),W=n(7),z=n.n(W),G=n(14),U=n(6);var q=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},V="[ \t]*",H="(?:=|\\$=|\\^=|\\*=|~=|\\|=)",X="(?:(?:[ \t]+)|(?:[ \t]*(>)[ \t]*)|(?:[ \t]*(\\+)[ \t]*)|(?:[ \t]*(~)[ \t]*))",K=new RegExp("^"+X+"$");function Z(t){var e=t.trim(),n=new RegExp("(:?[\\w-]+)?","y"),r=n.exec(e)[0],i=new RegExp('(?:\\.[\\w-]+)|(?:#[\\w-]+)|(?:\\[[ \t]*[\\w-]+[ \t]*(?:(?:=|\\$=|\\^=|\\*=|~=|\\|=)[ \t]*[^\\]]+[ \t]*)?\\])|:(?:first-child|last-child|nth-child\\((?:even|odd|\\d*(?:-?n(?:\\+\\d+)?)?)\\)|empty|root|contains\\("[^"]*"\\))|(?:(?:[ \t]+)|(?:[ \t]*(>)[ \t]*)|(?:[ \t]*(\\+)[ \t]*)|(?:[ \t]*(~)[ \t]*))',"y");i.lastIndex=n.lastIndex;for(var o=[],s=void 0,a=void 0,u=-1;i.lastIndex<e.length;){var c=i.exec(e);if(!c&&void 0===a)throw new Error("Parse error, invalid selector");if(c&&K.test(c[0])){a=K.exec(c[0])[0],u=i.lastIndex}else{if(void 0!==a){s=[Q(a),Z(e.substring(u))];break}o.push(c[0])}}var l=o.filter((function(t){return t.startsWith(".")})).map((function(t){return t.substring(1)})),f=o.filter((function(t){return t.startsWith("#")})).map((function(t){return t.substring(1)}));if(f.length>1)throw new Error("Invalid selector, only one id is allowed");var h=new RegExp("([\\w-]+)[ \t]*("+H+")?"+V+"([^\\]]+)?"),p=o.filter((function(t){return t.startsWith("[")})).map((function(t){return h.exec(t).slice(1,4)})).map((function(t){var e,n=t[0],r=t[1],i=t[2];return(e={})[n]=[J(r),i?Y(i):i],e})).reduce((function(t,e){return q({},t,e)}),{}),d=o.filter((function(t){return t.startsWith(":")})).map((function(t){return function(t){if("first-child"===t||"last-child"===t||"root"===t||"empty"===t)return[t,void 0];if(t.startsWith("contains")){return["contains",t.slice(10,-2)]}var e=t.slice(10,-1);"even"===e&&(e="2n");"odd"===e&&(e="2n+1");return["nth-child",e]}(t.substring(1))}));return{id:f[0]||"",tag:r,classList:l,attributes:p,nextSelector:s,pseudos:d}}function Y(t){if(t.startsWith('"'))return t.slice(1,-1);if("true"===t)return!0;if("false"===t)return!1;var e=parseFloat(t);return isNaN(e)?t:e}function J(t){switch(t){case"=":return"exact";case"^=":return"startsWith";case"$=":return"endsWith";case"*=":return"contains";case"~=":return"whitespace";case"|=":return"dash";default:return"has"}}function Q(t){switch(t.trim()){case">":return"child";case"+":return"nextSibling";case"~":return"sibling";default:return"subtree"}}function tt(t){return function(e,n){var r="object"==typeof e?e:Z(e),i=r.tag,o=r.id,s=r.classList,a=r.attributes,u=r.nextSelector,c=r.pseudos;if(void 0!==u)throw new Error("matches can only process selectors that target a single element");if(!n)return!1;if(i&&i.toLowerCase()!==t.tag(n).toLowerCase())return!1;if(o&&o!==t.id(n))return!1;for(var l=t.className(n).split(" "),f=0;f<s.length;f++)if(-1===l.indexOf(s[f]))return!1;for(var h in a){var p=t.attr(n,h),d=a[h][0],m=a[h][1];if(void 0===p)return!1;if("has"===d)return!0;if("exact"===d&&p!==m)return!1;if("exact"!==d){if("string"!=typeof m)throw new Error("All non-string values have to be an exact match");if("startsWith"===d&&!p.startsWith(m))return!1;if("endsWith"===d&&!p.endsWith(m))return!1;if("contains"===d&&-1===p.indexOf(m))return!1;if("whitespace"===d&&-1===p.split(" ").indexOf(m))return!1;if("dash"===d&&-1===p.split("-").indexOf(m))return!1}}for(f=0;f<c.length;f++){var y=c[f],v=(d=y[0],y[1]);if("contains"===d&&v!==t.contents(n))return!1;if("empty"===d&&(t.contents(n)||0!==t.children(n).length))return!1;if("root"===d&&void 0!==t.parent(n))return!1;if(-1!==d.indexOf("child")){if(!t.parent(n))return!1;var g=t.children(t.parent(n));if("first-child"===d&&0!==g.indexOf(n))return!1;if("last-child"===d&&g.indexOf(n)!==g.length-1)return!1;if("nth-child"===d){var b=/([\+-]?)(\d*)(n?)(\+\d+)?/.exec(v).slice(1),_=g.indexOf(n);b[0]||(b[0]="+");var x=b[1]?parseInt(b[0]+b[1]):void 0,w=parseInt(b[3]||"0");if(x&&"n"===b[2]&&_%x!==w)return!1;if(!x&&b[2]&&("+"===b[0]&&_-w<0||"-"===b[0]&&_-w>=0))return!1;if(!b[2]&&x&&_!==x-1)return!1}}}return!0}}function et(t){if(!t.sel)return{tagName:"",id:"",className:""};var e=t.sel,n=e.indexOf("#"),r=e.indexOf(".",n),i=n>0?n:e.length,o=r>0?r:e.length;return{tagName:-1!==n||-1!==r?e.slice(0,Math.min(i,o)):e,id:i<o?e.slice(i+1,o):void 0,className:r>0?e.slice(o+1).replace(/\./g," "):void 0}}function nt(t){var e=et(t).className,n=void 0===e?"":e;if(!t.data)return n;var r=t.data,i=r.class,o=r.props;i&&(n+=" "+Object.keys(i).filter((function(t){return i[t]})).join(" "));return o&&o.className&&(n+=" "+o.className),n&&n.trim()}var rt=n(5),it={tag:function(t){return et(t).tagName},className:function(t){return nt(t)},id:function(t){return et(t).id||""},children:function(t){return t.children||[]},parent:function(t){return t.data[rt.a]||t},contents:function(t){return t.text||""},attr:function(t,e){if(t.data){var n=t.data,r=n.attrs,i=void 0===r?{}:r,o=n.props,s=void 0===o?{}:o,a=n.dataset,u=void 0===a?{}:a;if(i[e])return i[e];if(s[e])return s[e];if(0===e.indexOf("data-")&&u[e.slice(5)])return u[e.slice(5)]}}},ot=tt(it);var st,at;st=it,at=function(t,e){var n=e.data,r=ot.bind(null,t);if(n&&n.fn){var i=void 0;return!!r(i=Array.isArray(n.args)?n.fn.apply(null,n.args):n.args?n.fn.call(null,n.args):n.fn())&&i}return r(e)}||tt(st);var ut=function(){function t(t){this.rootElement=t}return t.prototype.call=function(t){if(11===this.rootElement.nodeType)return this.wrapDocFrag(null===t?[]:[t]);if(null===t)return this.wrap([]);var e=et(t),n=e.tagName,r=e.id,i=nt(t),o=((t.data||{}).props||{}).id,s=void 0===o?r:o;return"string"==typeof s&&s.toUpperCase()===this.rootElement.id.toUpperCase()&&n.toUpperCase()===this.rootElement.tagName.toUpperCase()&&i.toUpperCase()===this.rootElement.className.toUpperCase()?t:this.wrap([t])},t.prototype.wrapDocFrag=function(t){return Object(U.vnode)("",{isolate:[]},t,void 0,this.rootElement)},t.prototype.wrap=function(t){var e=this.rootElement,n=e.tagName,r=e.id,i=e.className,o=r?"#"+r:"",s=i?"."+i.split(" ").join("."):"",a=Object(p.h)(""+n.toLowerCase()+o+s,{},t);return a.data=a.data||{},a.data.isolate=a.data.isolate||[],a},t}(),ct=n(8),lt=n.n(ct),ft=n(9),ht=n.n(ft),pt=n(10),dt=n.n(pt),mt=n(11),yt=n.n(mt),vt=n(12),gt=n.n(vt),bt=[yt.a,lt.a,ht.a,dt.a,gt.a],_t=function(){function t(t){this.mapper=t,this.tree=[void 0,{}]}return t.prototype.set=function(t,e,n){for(var r=this.tree,i=void 0!==n?n:t.length,o=0;o<i;o++){var s=this.mapper(t[o]),a=r[1][s];a||(a=[void 0,{}],r[1][s]=a),r=a}r[0]=e},t.prototype.getDefault=function(t,e,n){return this.get(t,e,n)},t.prototype.get=function(t,e,n){for(var r=this.tree,i=void 0!==n?n:t.length,o=0;o<i;o++){var s=this.mapper(t[o]),a=r[1][s];if(!a){if(!e)return;a=[void 0,{}],r[1][s]=a}r=a}return e&&!r[0]&&(r[0]=e()),r[0]},t.prototype.delete=function(t){for(var e=this.tree,n=0;n<t.length-1;n++){var r=e[1][this.mapper(t[n])];if(!r)return;e=r}delete e[1][this.mapper(t[t.length-1])]},t}(),xt=function(){function t(){this.namespaceTree=new _t((function(t){return t.scope})),this.namespaceByElement=new Map,this.vnodesBeingRemoved=[]}return t.prototype.setEventDelegator=function(t){this.eventDelegator=t},t.prototype.insertElement=function(t,e){this.namespaceByElement.set(e,t),this.namespaceTree.set(t,e)},t.prototype.removeElement=function(t){this.namespaceByElement.delete(t);var e=this.getNamespace(t);e&&this.namespaceTree.delete(e)},t.prototype.getElement=function(t,e){return this.namespaceTree.get(t,void 0,e)},t.prototype.getRootElement=function(t){if(this.namespaceByElement.has(t))return t;for(var e=t;!this.namespaceByElement.has(e);){if(!(e=e.parentNode))return;if("HTML"===e.tagName)throw new Error("No root element found, this should not happen at all")}return e},t.prototype.getNamespace=function(t){var e=this.getRootElement(t);if(e)return this.namespaceByElement.get(e)},t.prototype.createModule=function(){var t=this;return{create:function(e,n){var r=n.elm,i=n.data,o=(void 0===i?{}:i).isolate;Array.isArray(o)&&t.insertElement(o,r)},update:function(e,n){var r=e.elm,i=e.data,o=void 0===i?{}:i,s=n.elm,a=n.data,u=void 0===a?{}:a,c=o.isolate,l=u.isolate;x(c,l)||Array.isArray(c)&&t.removeElement(r),Array.isArray(l)&&t.insertElement(l,s)},destroy:function(e){t.vnodesBeingRemoved.push(e)},remove:function(e,n){t.vnodesBeingRemoved.push(e),n()},post:function(){for(var e=t.vnodesBeingRemoved,n=e.length-1;n>=0;n--){var r=e[n],i=void 0!==r.data?r.data.isolation:void 0;void 0!==i&&t.removeElement(i),t.eventDelegator.removeElement(r.elm,i)}t.vnodesBeingRemoved=[]}}},t}(),wt=function(){function t(){this.arr=[],this.prios=[]}return t.prototype.add=function(t,e){for(var n=0;n<this.arr.length;n++)if(this.prios[n]<e)return this.arr.splice(n,0,t),void this.prios.splice(n,0,e);this.arr.push(t),this.prios.push(e)},t.prototype.forEach=function(t){for(var e=0;e<this.arr.length;e++)t(this.arr[e],e,this.arr)},t.prototype.delete=function(t){for(var e=0;e<this.arr.length;e++)if(this.arr[e]===t)return this.arr.splice(e,1),void this.prios.splice(e,1)},t}(),Ot=function(){return(Ot=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Mt=["blur","canplay","canplaythrough","durationchange","emptied","ended","focus","load","loadeddata","loadedmetadata","mouseenter","mouseleave","pause","play","playing","ratechange","reset","scroll","seeked","seeking","stalled","submit","suspend","timeupdate","unload","volumechange","waiting"],Et=function(){function t(t,e){var n=this;this.rootElement$=t,this.isolateModule=e,this.virtualListeners=new _t((function(t){return t.scope})),this.nonBubblingListenersToAdd=new Set,this.virtualNonBubblingListener=[],this.isolateModule.setEventDelegator(this),this.domListeners=new Map,this.domListenersToAdd=new Map,this.nonBubblingListeners=new Map,t.addListener({next:function(t){n.origin!==t&&(n.origin=t,n.resetEventListeners(),n.domListenersToAdd.forEach((function(t,e){return n.setupDOMListener(e,t)})),n.domListenersToAdd.clear()),n.nonBubblingListenersToAdd.forEach((function(t){n.setupNonBubblingListener(t)}))}})}return t.prototype.addEventListener=function(t,e,n,r){var o,s=i.a.never(),a=new w(e,this.isolateModule);if(void 0===r?-1===Mt.indexOf(t):r)return this.domListeners.has(t)||this.setupDOMListener(t,!!n.passive),o=this.insertListener(s,a,t,n),s;var u=[];this.nonBubblingListenersToAdd.forEach((function(t){return u.push(t)}));for(var c=void 0,l=0,f=u.length,h=function(n){n[0];var r=n[1],i=n[2];n[3];return t===r&&x(i.namespace,e)};!c&&l<f;){var p=u[l];c=h(p)?p:c,l++}var d,m=c;if(m){var y=m[0];d=y}else{var v=new O(e,this.isolateModule);o=this.insertListener(s,a,t,n),m=[s,t,v,o],d=s,this.nonBubblingListenersToAdd.add(m),this.setupNonBubblingListener(m)}var g=this,b=null;return i.a.create({start:function(t){b=d.subscribe(t)},stop:function(){m[0];var t=m[1],e=m[2];m[3];e.call().forEach((function(e){var n=e.subs;n&&n[t]&&(n[t].unsubscribe(),delete n[t])})),g.nonBubblingListenersToAdd.delete(m),b.unsubscribe()}})},t.prototype.removeElement=function(t,e){void 0!==e&&this.virtualListeners.delete(e);var n=[];this.nonBubblingListeners.forEach((function(e,r){if(e.has(t)){n.push([r,t]);var i=t.subs;i&&Object.keys(i).forEach((function(t){i[t].unsubscribe()}))}}));for(var r=0;r<n.length;r++){var i=this.nonBubblingListeners.get(n[r][0]);i&&(i.delete(n[r][1]),0===i.size?this.nonBubblingListeners.delete(n[r][0]):this.nonBubblingListeners.set(n[r][0],i))}},t.prototype.insertListener=function(t,e,n,r){var i=[],o=e._namespace,s=o.length;do{i.push(this.getVirtualListeners(n,o,!0,s)),s--}while(s>=0&&"total"!==o[s].type);for(var a=Ot({},r,{scopeChecker:e,subject:t,bubbles:!!r.bubbles,useCapture:!!r.useCapture,passive:!!r.passive}),u=0;u<i.length;u++)i[u].add(a,o.length);return a},t.prototype.getVirtualListeners=function(t,e,n,r){void 0===n&&(n=!1);var i=void 0!==r?r:e.length;if(!n)for(var o=i-1;o>=0;o--){if("total"===e[o].type){i=o+1;break}i=o}var s=this.virtualListeners.getDefault(e,(function(){return new Map}),i);return s.has(t)||s.set(t,new wt),s.get(t)},t.prototype.setupDOMListener=function(t,e){var n=this;if(this.origin){var r=m(this.origin,t,!1,!1,e).subscribe({next:function(r){return n.onEvent(t,r,e)},error:function(){},complete:function(){}});this.domListeners.set(t,{sub:r,passive:e})}else this.domListenersToAdd.set(t,e)},t.prototype.setupNonBubblingListener=function(t){t[0];var e=t[1],n=t[2],r=t[3];if(this.origin){var i=n.call();if(i.length){var o=this;i.forEach((function(t){var n,i=t.subs;if(!i||!i[e]){var s=m(t,e,!1,!1,r.passive).subscribe({next:function(t){return o.onEvent(e,t,!!r.passive,!1)},error:function(){},complete:function(){}});o.nonBubblingListeners.has(e)||o.nonBubblingListeners.set(e,new Map);var a=o.nonBubblingListeners.get(e);if(!a)return;a.set(t,{sub:s,destination:r}),t.subs=Ot({},i,((n={})[e]=s,n))}}))}}},t.prototype.resetEventListeners=function(){for(var t=this.domListeners.entries(),e=t.next();!e.done;){var n=e.value,r=n[0],i=n[1],o=i.sub,s=i.passive;o.unsubscribe(),this.setupDOMListener(r,s),e=t.next()}},t.prototype.putNonBubblingListener=function(t,e,n,r){var i=this.nonBubblingListeners.get(t);if(i){var o=i.get(e);o&&o.destination.passive===r&&o.destination.useCapture===n&&(this.virtualNonBubblingListener[0]=o.destination)}},t.prototype.onEvent=function(t,e,n,r){void 0===r&&(r=!0);var i=this.patchEvent(e),o=this.isolateModule.getRootElement(e.target);if(r){var s=this.isolateModule.getNamespace(e.target);if(!s)return;var a=this.getVirtualListeners(t,s);this.bubble(t,e.target,o,i,a,s,s.length-1,!0,n),this.bubble(t,e.target,o,i,a,s,s.length-1,!1,n)}else this.putNonBubblingListener(t,e.target,!0,n),this.doBubbleStep(t,e.target,o,i,this.virtualNonBubblingListener,!0,n),this.putNonBubblingListener(t,e.target,!1,n),this.doBubbleStep(t,e.target,o,i,this.virtualNonBubblingListener,!1,n),e.stopPropagation()},t.prototype.bubble=function(t,e,n,r,i,o,s,a,u){a||r.propagationHasBeenStopped||this.doBubbleStep(t,e,n,r,i,a,u);var c=n,l=s;if(e===n){if(!(s>=0&&"sibling"===o[s].type))return;c=this.isolateModule.getElement(o,s),l--}e.parentNode&&c&&this.bubble(t,e.parentNode,c,r,i,o,l,a,u),a&&!r.propagationHasBeenStopped&&this.doBubbleStep(t,e,n,r,i,a,u)},t.prototype.doBubbleStep=function(t,e,n,r,i,o,s){n&&(this.mutateEventCurrentTarget(r,e),i.forEach((function(t){if(t.passive===s&&t.useCapture===o){var i=_(t.scopeChecker.namespace);!r.propagationHasBeenStopped&&t.scopeChecker.isDirectlyInScope(e)&&(""!==i&&e.matches(i)||""===i&&e===n)&&(y(r,t.preventDefault),t.subject.shamefullySendNext(r))}})))},t.prototype.patchEvent=function(t){var e=t;e.propagationHasBeenStopped=!1;var n=e.stopPropagation;return e.stopPropagation=function(){n.call(this),this.propagationHasBeenStopped=!0},e},t.prototype.mutateEventCurrentTarget=function(t,e){try{Object.defineProperty(t,"currentTarget",{value:e,configurable:!0})}catch(t){console.log("please use event.ownerTarget")}t.ownerTarget=e},t}();function jt(t){return i.a.merge(t,i.a.never())}function St(t){return t.elm}function kt(t){(console.error||console.log)(t)}function At(t,e){void 0===e&&(e={}),b(t);var n=e.modules||bt;!function(t){if(!Array.isArray(t))throw new Error("Optional modules option must be an array for snabbdom modules")}(n);var r,o,s=new xt,a=R([s.createModule()].concat(n)),u=i.a.create({start:function(t){"loading"===document.readyState?document.addEventListener("readystatechange",(function(){var e=document.readyState;"interactive"!==e&&"complete"!==e||(t.next(null),t.complete())})):(t.next(null),t.complete())},stop:function(){}}),c=i.a.create({start:function(t){o=new MutationObserver((function(){return t.next(null)}))},stop:function(){o.disconnect()}});return function(n,l){void 0===l&&(l="DOM"),function(t){if(!t||"function"!=typeof t.addListener||"function"!=typeof t.fold)throw new Error("The DOM driver function expects as input a Stream of virtual DOM elements")}(n);var f=i.a.create(),h=u.map((function(){var e=function(t){var e="string"==typeof t?document.querySelector(t):t;if("string"==typeof t&&null===e)throw new Error("Cannot render into unknown element `"+t+"`");return e}(t)||document.body;return r=new ut(e),e})),p=n.remember();p.addListener({}),c.addListener({});var d=h.map((function(t){return i.a.merge(p.endWhen(f),f).map((function(t){return r.call(t)})).startWith((e=Object(G.toVNode)(t),e.data=e.data||{},e.data.isolate=[],e)).fold(a,Object(G.toVNode)(t)).drop(1).map(St).startWith(t).map((function(t){return o.observe(t,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),t})).compose(jt);var e})).flatten(),m=F()(u,c).endWhen(f).compose(z()(d)).map((function(t){return t[1]})).remember();m.addListener({error:e.reportSnabbdomError||kt});var y=new Et(m,s);return new j(m,f,[],s,y,l)}}!function(){function t(t){this._mockConfig=t,t.elements?this._elements=t.elements:this._elements=Object(d.adapt)(i.a.empty())}t.prototype.elements=function(){var t=this._elements;return t._isCycleSource="MockedDOM",t},t.prototype.element=function(){var t=this.elements().filter((function(t){return t.length>0})).map((function(t){return t[0]})).remember(),e=Object(d.adapt)(t);return e._isCycleSource="MockedDOM",e},t.prototype.events=function(t,e,n){var r=this._mockConfig[t],o=Object(d.adapt)(r||i.a.empty());return o._isCycleSource="MockedDOM",o},t.prototype.select=function(e){return new t(this._mockConfig[e]||{})},t.prototype.isolateSource=function(t,e){return t.select(".___"+e)},t.prototype.isolateSink=function(t,e){return Object(d.adapt)(i.a.fromObservable(t).map((function(t){return t.sel&&-1!==t.sel.indexOf("___"+e)||(t.sel+=".___"+e),t})))}}();function Tt(t){return function(t){return"string"==typeof t&&t.length>0}(t)&&("."===t[0]||"#"===t[0])}function Ct(t){return function(e,n,r){var i=void 0!==e,o=void 0!==n,s=void 0!==r;return Tt(e)?o&&s?Object(p.h)(t+e,n,r):o?Object(p.h)(t+e,n):Object(p.h)(t+e,{}):s?Object(p.h)(t+e,n,r):o?Object(p.h)(t,e,n):i?Object(p.h)(t,e):Object(p.h)(t,{})}}var Dt=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","colorProfile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotlight","feTile","feTurbulence","filter","font","fontFace","fontFaceFormat","fontFaceName","fontFaceSrc","fontFaceUri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missingGlyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Pt=Ct("svg");Dt.forEach((function(t){Pt[t]=Ct(t)}));var Nt=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","meta","nav","noscript","object","ol","optgroup","option","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","video"],It={SVG_TAG_NAMES:Dt,TAG_NAMES:Nt,svg:Pt,isSelector:Tt,createTagFunction:Ct};Nt.forEach((function(t){It[t]=Ct(t)}));var Lt=It,Bt=(Lt.svg,Lt.a,Lt.abbr,Lt.address,Lt.area,Lt.article,Lt.aside,Lt.audio,Lt.b,Lt.base,Lt.bdi,Lt.bdo,Lt.blockquote,Lt.body,Lt.br,Lt.button,Lt.canvas),Rt=(Lt.caption,Lt.cite,Lt.code,Lt.col,Lt.colgroup,Lt.dd,Lt.del,Lt.dfn,Lt.dir,Lt.div),$t=(Lt.dl,Lt.dt,Lt.em,Lt.embed,Lt.fieldset,Lt.figcaption,Lt.figure,Lt.footer,Lt.form,Lt.h1,Lt.h2,Lt.h3,Lt.h4,Lt.h5,Lt.h6,Lt.head,Lt.header,Lt.hgroup,Lt.hr,Lt.html,Lt.i,Lt.iframe,Lt.img,Lt.input),Ft=(Lt.ins,Lt.kbd,Lt.keygen,Lt.label,Lt.legend,Lt.li,Lt.link,Lt.main,Lt.map,Lt.mark,Lt.menu,Lt.meta,Lt.nav,Lt.noscript,Lt.object,Lt.ol,Lt.optgroup,Lt.option),Wt=(Lt.p,Lt.param,Lt.pre,Lt.progress,Lt.q,Lt.rp,Lt.rt,Lt.ruby,Lt.s,Lt.samp,Lt.script,Lt.section,Lt.select),zt=(Lt.small,Lt.source,Lt.span),Gt=(Lt.strong,Lt.style,Lt.sub,Lt.sup,Lt.table,Lt.tbody,Lt.td,Lt.textarea,Lt.tfoot,Lt.th,Lt.thead,Lt.title,Lt.tr,Lt.u,Lt.ul,Lt.video);const Ut={main:{},none:{display:"none"},active:{}},qt={},Vt={main:{position:"absolute",top:0,left:"-1950px",transition:"all 500ms ease-in-out",zIndex:999},active:{position:"absolute",top:0,left:0,transition:"all 500ms ease-in-out",zIndex:999}},Ht={},Xt={},Kt={},Zt={},Yt={},Jt={};var Qt=n(23);function te(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ee(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ee(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const ne=[{width:320,height:240},{width:640,height:480},{width:1280,height:720},{width:1920,height:1080}];let re;const ie=[];var oe=function(t,e){const n=t.config.map(t=>t.camera_params.rearCamera).take(2),r=i.a.combine(e.videoSize$,e.camID$,n).map(t=>i.a.fromPromise(function(t){let e=te(t,3),n=e[0],r=e[1],i=e[2];const o=ne[n];return re&&re.getTracks().forEach(t=>{t.stop()}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return e?new Promise((function(n,r){e.call(navigator,t,n,r)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),navigator.mediaDevices.getUserMedia({video:{width:o.width,height:o.height,deviceId:0===r||i?{}:{exact:r},facingMode:i?{exact:"environment"}:{}}})}(t))).flatten(),o=i.a.of(Gt("#beholder-video",{attrs:{autoplay:!0,playsinline:!0}}));return i.a.combine(t.DOM.select("#beholder-video").element(),r,e.torch$).subscribe({next:t=>{let e=te(t,3),n=e[0],r=e[1],i=e[2];if("srcObject"in n?n.srcObject=r:n.src=window.URL.createObjectURL(r),n.play(),re=r,ie.forEach(t=>t(re)),i)if(ImageCapture){const t=r.getVideoTracks()[0];new ImageCapture(t).getPhotoCapabilities().then(()=>{void 0!==t.getCapabilities().torch&&t.applyConstraints({advanced:[{torch:i}]})})}else console.warn("BEHOLDER WARNS: Flahslight/Torch functionality is not supported on this device or platform")},error:t=>console.log(t)}),{vdom$:o}},se=se||{};se.Image=function(t,e,n){this.width=t||0,this.height=e||0,this.data=n||[]},se.grayscale=function(t,e){for(var n=t.data,r=e.data,i=n.length,o=0,s=0;o<i;o+=4)r[s++]=.299*n[o]+.587*n[o+1]+.114*n[o+2]+.5&255;return e.width=t.width,e.height=t.height,e},se.threshold=function(t,e,n){var r,i=t.data,o=e.data,s=i.length,a=[];for(r=0;r<256;++r)a[r]=r<=n?0:255;for(r=0;r<s;++r)o[r]=a[i[r]];return e.width=t.width,e.height=t.height,e},se.adaptiveThreshold=function(t,e,n,r){var i,o=t.data,s=e.data,a=o.length,u=[];for(se.stackBoxBlur(t,e,n),i=0;i<768;++i)u[i]=i-255<=-r?255:0;for(i=0;i<a;++i)s[i]=u[o[i]-s[i]+255];return e.width=t.width,e.height=t.height,e},se.otsu=function(t){var e,n,r,i=t.data,o=i.length,s=[],a=0,u=0,c=0,l=0,f=0,h=0;for(r=0;r<256;++r)s[r]=0;for(r=0;r<o;++r)s[i[r]]++;for(r=0;r<256;++r)u+=s[r]*r;for(r=0;r<256;++r)if(0!==(l+=s[r])){if(0===(f=o-l))break;(n=l*f*(e=(c+=s[r]*r)/l-(u-c)/f)*e)>h&&(h=n,a=r)}return a},se.stackBoxBlurMult=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265],se.stackBoxBlurShift=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13],se.BlurStack=function(){this.color=0,this.next=null},se.stackBoxBlur=function(t,e,n){var r,i,o,s,a,u,c,l,f,h,p=t.data,d=e.data,m=t.height,y=t.width,v=m-1,g=y-1,b=n+n+1,_=n+1,x=se.stackBoxBlurMult[n],w=se.stackBoxBlurShift[n];for(r=i=new se.BlurStack,h=1;h<b;++h)r=r.next=new se.BlurStack;for(r.next=i,a=0,f=0;f<m;++f){for(u=a,s=_*(o=p[a]),r=i,h=0;h<_;++h)r.color=o,r=r.next;for(h=1;h<_;++h)r.color=p[a+h],s+=r.color,r=r.next;for(r=i,l=0;l<y;++l)d[a++]=s*x>>>w,c=u+((c=l+_)<g?c:g),s-=r.color-p[c],r.color=p[c],r=r.next}for(l=0;l<y;++l){for(u=(a=l)+y,s=_*(o=d[a]),r=i,h=0;h<_;++h)r.color=o,r=r.next;for(h=1;h<_;++h)r.color=d[u],s+=r.color,r=r.next,u+=y;for(r=i,f=0;f<m;++f)d[a]=s*x>>>w,c=l+((c=f+_)<v?c:v)*y,s-=r.color-d[c],r.color=d[c],r=r.next,a+=y}return e},se.gaussianBlur=function(t,e,n,r){var i=se.gaussianKernel(r);return e.width=t.width,e.height=t.height,n.width=t.width,n.height=t.height,se.gaussianBlurFilter(t,n,i,!0),se.gaussianBlurFilter(n,e,i,!1),e},se.findContours=function(t,e){var n,r,i,o,s,a,u,c,l,f=t.width,h=t.height,p=[];for(n=se.binaryBorder(t,e),r=se.neighborhoodDeltas(f+2),i=f+3,s=1,c=0;c<h;++c,i+=2)for(l=0;l<f;++l,++i)0!==(o=n[i])&&(a=u=!1,1===o&&0===n[i-1]?a=!0:o>=1&&0===n[i+1]&&(u=!0),(a||u)&&(++s,p.push(se.borderFollowing(n,i,s,{x:l,y:c},u,r))));return p},se.borderFollowing=function(t,e,n,r,i,o){var s,a,u,c,l,f=[];f.hole=i,c=l=i?0:4;do{if(0!==t[s=e+o[c=c-1&7]])break}while(c!==l);if(c===l)t[e]=-n,f.push({x:r.x,y:r.y});else for(a=e,4^c;;){l=c;do{u=a+o[++c]}while(0===t[u]);if((c&=7)-1>>>0<l>>>0?t[a]=-n:1===t[a]&&(t[a]=n),f.push({x:r.x,y:r.y}),c,r.x+=se.neighborhood[c][0],r.y+=se.neighborhood[c][1],u===e&&a===s)break;a=u,c=c+4&7}return f},se.neighborhood=[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1]],se.neighborhoodDeltas=function(t){for(var e=[],n=se.neighborhood.length,r=0;r<n;++r)e[r]=se.neighborhood[r][0]+se.neighborhood[r][1]*t;return e.concat(e)},se.approxPolyDP=function(t,e){var n,r,i,o,s,a,u,c,l,f,h,p={start_index:0,end_index:0},d={start_index:0,end_index:0},m=[],y=[],v=t.length;for(e*=e,h=0,l=0;l<3;++l)for(s=0,r=t[h=(h+d.start_index)%v],++h===v&&(h=0),f=1;f<v;++f)n=t[h],++h===v&&(h=0),(o=(u=n.x-r.x)*u+(c=n.y-r.y)*c)>s&&(s=o,d.start_index=f);for(s<=e?m.push({x:r.x,y:r.y}):(p.start_index=h,p.end_index=d.start_index+=p.start_index,d.start_index-=d.start_index>=v?v:0,d.end_index=p.start_index,d.end_index<d.start_index&&(d.end_index+=v),y.push({start_index:d.start_index,end_index:d.end_index}),y.push({start_index:p.start_index,end_index:p.end_index}));0!==y.length;){if(i=t[(p=y.pop()).end_index%v],r=t[h=p.start_index%v],++h===v&&(h=0),p.end_index<=p.start_index+1)a=!0;else{for(s=0,u=i.x-r.x,c=i.y-r.y,l=p.start_index+1;l<p.end_index;++l)n=t[h],++h===v&&(h=0),(o=Math.abs((n.y-r.y)*u-(n.x-r.x)*c))>s&&(s=o,d.start_index=l);a=s*s<=e*(u*u+c*c)}a?m.push({x:r.x,y:r.y}):(d.end_index=p.end_index,p.end_index=d.start_index,y.push({start_index:d.start_index,end_index:d.end_index}),y.push({start_index:p.start_index,end_index:p.end_index}))}return m},se.warp=function(t,e,n,r){var i,o,s,a,u,c,l,f,h,p,d,m,y,v,g,b,_,x,w,O,M,E,j=t.data,S=e.data,k=t.width,A=t.height,T=0;for(y=(m=se.getPerspectiveTransform(n,r-1))[8],v=m[2],g=m[5],M=0;M<r;++M)for(b=y+=m[7],_=v+=m[1],x=g+=m[4],E=0;E<r;++E)b+=m[6],o=(i=(w=(_+=m[0])/b)>>>0)===k-1?i:i+1,a=1-(s=w-i),l=1-(c=(O=(x+=m[3])/b)-(u=O>>>0)),f=h=u*k,p=d=(u===A-1?u:u+1)*k,S[T++]=l*(a*j[f+i]+s*j[h+o])+c*(a*j[p+i]+s*j[d+o])&255;return e.width=r,e.height=r,e},se.getPerspectiveTransform=function(t,e){var n=se.square2quad(t);return n[0]/=e,n[1]/=e,n[3]/=e,n[4]/=e,n[6]/=e,n[7]/=e,n},se.square2quad=function(t){var e,n,r,i,o,s,a,u=[];return e=t[0].x-t[1].x+t[2].x-t[3].x,n=t[0].y-t[1].y+t[2].y-t[3].y,0===e&&0===n?(u[0]=t[1].x-t[0].x,u[1]=t[2].x-t[1].x,u[2]=t[0].x,u[3]=t[1].y-t[0].y,u[4]=t[2].y-t[1].y,u[5]=t[0].y,u[6]=0,u[7]=0,u[8]=1):(r=t[1].x-t[2].x,i=t[3].x-t[2].x,o=t[1].y-t[2].y,a=r*(s=t[3].y-t[2].y)-i*o,u[6]=(e*s-i*n)/a,u[7]=(r*n-e*o)/a,u[8]=1,u[0]=t[1].x-t[0].x+u[6]*t[1].x,u[1]=t[3].x-t[0].x+u[7]*t[3].x,u[2]=t[0].x,u[3]=t[1].y-t[0].y+u[6]*t[1].y,u[4]=t[3].y-t[0].y+u[7]*t[3].y,u[5]=t[0].y),u},se.isContourConvex=function(t){var e,n,r,i,o,s,a,u,c=0,l=!0,f=t.length,h=0,p=0;for(n=t[f-1],o=(e=t[0]).x-n.x,s=e.y-n.y;h<f;++h){if(++p===f&&(p=0),n=e,a=(e=t[p]).x-n.x,3===(c|=(i=(u=e.y-n.y)*o)>(r=a*s)?1:i<r?2:3)){l=!1;break}o=a,s=u}return l},se.perimeter=function(t){for(var e,n,r=t.length,i=0,o=r-1,s=0;i<r;o=i++)e=t[i].x-t[o].x,n=t[i].y-t[o].y,s+=Math.sqrt(e*e+n*n);return s},se.minEdgeLength=function(t){for(var e,n,r,i=t.length,o=0,s=i-1,a=1/0;o<i;s=o++)(e=(n=t[o].x-t[s].x)*n+(r=t[o].y-t[s].y)*r)<a&&(a=e);return Math.sqrt(a)},se.countNonZero=function(t,e){var n,r,i=t.data,o=e.height,s=e.width,a=e.x+e.y*t.width,u=t.width-s,c=0;for(n=0;n<o;++n){for(r=0;r<s;++r)0!==i[a++]&&++c;a+=u}return c},se.binaryBorder=function(t,e){var n,r,i=t.data,o=t.height,s=t.width,a=0,u=0;for(r=-2;r<s;++r)e[u++]=0;for(n=0;n<o;++n){for(e[u++]=0,r=0;r<s;++r)e[u++]=0===i[a++]?0:1;e[u++]=0}for(r=-2;r<s;++r)e[u++]=0;return e};var ae=se;function ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ce(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(n),!0).forEach((function(e){le(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function le(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const fe={};let he={MIN_MARKER_DISTANCE:10,MIN_MARKER_PERIMETER:.2,MAX_MARKER_PERIMETER:.8,SIZE_AFTER_PERSPECTIVE_REMOVAL:49};fe.setCameraParams=t=>{he=ce(ce({},he),t)},fe.Marker=(t,e)=>{const n=(e[0].y-e[2].y)/(e[0].x-e[2].x),r=(e[1].y-e[3].y)/(e[1].x-e[3].x),i={x:0,y:0};return i.x=function(t,e,n,r){return(n.y-r.y+e*r.x-t*n.x)/(e-t)}(n,r,e[0],e[1]),i.y=function(t,e,n){return e*(n-t.x)+t.y}(e[0],n,i.x),{id:t,corners:e,center:i}},fe.Detector=function(){this.grey=new ae.Image,this.thres=new ae.Image,this.homography=new ae.Image,this.binary=[],this.contours=[],this.polys=[],this.candidates=[]},fe.Detector.prototype.detect=function(t,e){return ae.grayscale(t,this.grey),ae.adaptiveThreshold(this.grey,this.thres,2,7),this.contours=ae.findContours(this.thres,this.binary),this.candidates=this.findCandidates(this.contours,t.width*e.minMarkerPerimeter,t.width*e.maxMarkerPerimeter,.05,10),this.candidates=this.clockwiseCorners(this.candidates),this.candidates=this.notTooNear(this.candidates,e.minMarkerDistance),this.findMarkers(this.grey,this.candidates,e.sizeAfterPerspectiveRemoval)},fe.Detector.prototype.findCandidates=function(t,e,n,r,i){var o,s,a,u=[],c=t.length;for(this.polys=[],a=0;a<c;++a)(o=t[a]).length>=e&&o.length<=n&&(s=ae.approxPolyDP(o,o.length*r),this.polys.push(s),4===s.length&&ae.isContourConvex(s)&&ae.minEdgeLength(s)>=i&&u.push(s));return u},fe.Detector.prototype.clockwiseCorners=function(t){var e,n,r,i,o,s=t.length;for(o=0;o<s;++o)e=t[o][1].x-t[o][0].x,r=t[o][1].y-t[o][0].y,n=t[o][2].x-t[o][0].x,e*(t[o][2].y-t[o][0].y)-r*n<0&&(i=t[o][1],t[o][1]=t[o][3],t[o][3]=i);return t},fe.Detector.prototype.notTooNear=function(t,e){var n,r,i,o,s,a,u=[],c=t.length;for(o=0;o<c;++o)for(s=o+1;s<c;++s){for(n=0,a=0;a<4;++a)n+=(r=t[o][a].x-t[s][a].x)*r+(i=t[o][a].y-t[s][a].y)*i;n/4<e*e&&(ae.perimeter(t[o])<ae.perimeter(t[s])?t[o].tooNear=!0:t[s].tooNear=!0)}for(o=0;o<c;++o)t[o].tooNear||u.push(t[o]);return u},fe.Detector.prototype.findMarkers=function(t,e,n){var r,i,o,s=[],a=e.length;for(o=0;o<a;++o)r=e[o],ae.warp(t,this.homography,r,n),ae.threshold(this.homography,this.homography,ae.otsu(this.homography)),(i=this.getMarker(this.homography,r))&&s.push(i);return s},fe.Detector.prototype.getMarker=function(t,e){var n,r,i,o,s,a=t.width/7>>>0,u=a*a>>1,c=[],l=[],f=[];for(o=0;o<7;++o)for(i=0===o||6===o?1:6,s=0;s<7;s+=i)if(n={x:s*a,y:o*a,width:a,height:a},ae.countNonZero(t,n)>u)return null;for(o=0;o<5;++o)for(c[o]=[],s=0;s<5;++s)n={x:(s+1)*a,y:(o+1)*a,width:a,height:a},c[o][s]=ae.countNonZero(t,n)>u?1:0;for(l[0]=c,f[0]=this.hammingDistance(l[0]),r={first:f[0],second:0},o=1;o<4;++o)l[o]=this.rotate(l[o-1]),f[o]=this.hammingDistance(l[o]),f[o]<r.first&&(r.first=f[o],r.second=o);return 0!==r.first?null:fe.Marker(this.mat2id(l[r.second]),this.rotate2(e,4-r.second))},fe.Detector.prototype.hammingDistance=function(t){var e,n,r,i,o,s=[[1,0,0,0,0],[1,0,1,1,1],[0,1,0,0,1],[0,1,1,1,0]],a=0;for(r=0;r<5;++r){for(n=1/0,i=0;i<4;++i){for(e=0,o=0;o<5;++o)e+=t[r][o]===s[i][o]?0:1;e<n&&(n=e)}a+=n}return a},fe.Detector.prototype.mat2id=function(t){var e,n=0;for(e=0;e<5;++e)n<<=1,n|=t[e][1],n<<=1,n|=t[e][3];return n},fe.Detector.prototype.rotate=function(t){var e,n,r=[],i=t.length;for(e=0;e<i;++e)for(r[e]=[],n=0;n<t[e].length;++n)r[e][n]=t[t[e].length-n-1][e];return r},fe.Detector.prototype.rotate2=function(t,e){var n,r=[],i=t.length;for(n=0;n<i;++n)r[n]=t[(e+n)%i];return r};var pe=fe;function de(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return me(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ye(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ve(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ye(Object(n),!0).forEach((function(e){ge(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ge(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}let be={CAMERA_INFO:{},VIDEO_SIZE:{width:{exact:640},height:{exact:480}},minMarkerDistance:10,minMarkerPerimeter:.02,maxMarkerPerimeter:.8,sizeAfterPerspectiveRemoval:49};var _e=function(t){const e=t.DOM.select("#detection-canvas").element(),n=e.map(t=>t.getContext("2d")),r=t.DOM.select("#beholder-video").element(),o=t.update,s=new pe.Detector;return t.config.subscribe({next:t=>{be=ve(ve({},be),t.detection_params)}}),{marker$:i.a.combine(e,n,o,r).compose(z()(t.config)).map(t=>{let e=de(t,2),n=e[0],r=e[1].feed_params;const i=de(n,4),o=i[0],a=i[1],u=i[2],c=i[3];if(4===c.readyState){c.clientWidth>20&&o.width!==c.clientWidth&&(o.width=c.clientWidth,o.height=c.clientHeight),a.filter=`contrast(${(100+Math.floor(r.contrast))/100})\n         brightness(${(100+Math.floor(r.brightness))/100})\n         grayscale(${Math.floor(r.grayscale)/100})`,r.flip?(a.save(),a.translate(o.width,0),a.scale(-1,1),a.drawImage(c,0,0,o.width,o.height),a.restore()):a.drawImage(c,0,0,o.width,o.height);let t=a.getImageData(0,0,o.width,o.height);return[s.detect(t,be),u,o.width,o.height]}return[[],u,o.width,o.height]})}};class xe{static sub(t,e){return new xe(e.x-t.x,e.y-t.y)}static fromAngle(t){return new xe(Math.cos(t),Math.sin(t))}static add(t,e){return new xe(e.x+t.x,e.y+t.y)}static addScalar(t,e,n){const r=t.x+e.x*n,i=t.y+e.y*n;return new xe(r,i)}static mag(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static angleBetween(t,e){return Math.atan2(t.x*e.y-t.y*e.x,t.x*e.x+t.y*e.y)}static rotate(t,e){const n=t.x*Math.cos(e)-t.y*Math.sin(e),r=t.x*Math.sin(e)+t.y*Math.cos(e);return new xe(n,r)}static scale(t,e){return new xe(t.x*e,t.y*e)}static dist(t,e){return new xe(e.x-t.x,e.y-t.y).mag()}static dist2(t,e){return new xe(e.x-t.x,e.y-t.y).mag2()}static normalize(t){const e=t.mag();return new xe(t.x/e,t.y/e)}static copy(t){return new xe(t.x,t.y)}constructor(t,e){this.x=t,this.y=e}clone(){return new xe(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}set(t,e){return this.x=t,this.y=e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}scale(t){return this.x*=t,this.y*=t,this}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}mag2(){return this.x*this.x+this.y*this.y}dist(t){return xe.sub(this,t).mag()}dist2(t){return xe.sub(this,t).mag2()}normalize(){const t=this.mag();return this.x/=t,this.y/=t,this}getAngle(){return Math.atan2(this.y,this.x)}rotate(t){const e=this.x*Math.cos(t)-this.y*Math.sin(t),n=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=e,this.y=n,this}dot(t){return this.x*t.x+this.y*t.y}}var we=class{constructor(t){this.timeout=50,this.timestamp=this.timeout,this.present=!1,this.center=new xe(0,0),this.corners=[],this.rotation=0,this.scale=29/640,this.enable3D=!1,this.avgPerim=0,this.id=t}setScale(t,e){this.scale=t/e}update(t){this.timestamp=0,this.present=!0,this.center.x=t.center.x,this.center.y=t.center.y,this.corners=t.corners.map(t=>t),this.rotation=xe.angleBetween(xe.sub(this.corners[0],this.corners[1]),new xe(1,0));const e=this.corners.map((t,e,n)=>{const r=t.x-n[(e+1)%n.length].x,i=t.y-n[(e+1)%n.length].y;return Math.sqrt(r*r+i*i)});this.avgPerim=(e[0]+e[1]+e[2]+e[3])/4,this.enable3D&&(this.center.z=this.avgPerim/this.scale)}updatePresence(t){this.timestamp+=t>30?30:t,this.present=!(this.timestamp>=this.timeout)}},Oe=n(1);var Me=class{constructor(t,e){this.markerA=t,this.markerB=e}get isPresent(){return this.markerA.present&&this.markerB.present}get angleBetween(){return this.markerA.rotation-this.markerB.rotation}get distance(){return xe.sub(this.markerA.center,this.markerB.center).mag()}getRelativePosition(t){if(this.isPresent()){const e=[{x:-t/2,y:-t/2},{x:t/2,y:-t/2},{x:t/2,y:t/2},{x:-t/2,y:t/2}],n=function(t,e,n,r,i,o,s,a){const u=Oe.matrix([[i.x,i.y,1,0,0,0,-t.x*i.x,-t.x*i.y],[0,0,0,i.x,i.y,1,-t.y*i.x,-t.y*i.y],[o.x,o.y,1,0,0,0,-e.x*o.x,-e.x*o.y],[0,0,0,o.x,o.y,1,-e.y*o.x,-e.y*o.y],[s.x,s.y,1,0,0,0,-n.x*s.x,-n.x*s.y],[0,0,0,s.x,s.y,1,-n.y*s.x,-n.y*s.y],[a.x,a.y,1,0,0,0,-r.x*a.x,-r.x*a.y],[0,0,0,a.x,a.y,1,-r.y*a.x,-r.y*a.y]]),c=Oe.matrix([[t.x],[t.y],[e.x],[e.y],[n.x],[n.y],[r.x],[r.y]]),l=Oe.lusolve(u,c);return Oe.matrix([[Oe.subset(l,Oe.index(0,0)),Oe.subset(l,Oe.index(1,0)),Oe.subset(l,Oe.index(2,0))],[Oe.subset(l,Oe.index(3,0)),Oe.subset(l,Oe.index(4,0)),Oe.subset(l,Oe.index(5,0))],[Oe.subset(l,Oe.index(6,0)),Oe.subset(l,Oe.index(7,0)),1]])}(this.markerA.corners[0],this.markerA.corners[1],this.markerA.corners[2],this.markerA.corners[3],e[0],e[1],e[2],e[3]),r=Oe.inv(n),i=t=>function(t,e){const n=Oe.matrix([[e.x],[e.y],[1]]),r=Oe.multiply(t,n);return{x:Oe.subset(r,Oe.index(0,0))/Oe.subset(r,Oe.index(2,0)),y:Oe.subset(r,Oe.index(1,0))/Oe.subset(r,Oe.index(2,0))}}(r,t),o=i(this.markerA.center),s=i(this.markerB.center),a=i(this.markerA.corners[0]),u=i(this.markerA.corners[1]),c=i(this.markerB.corners[0]),l=i(this.markerB.corners[1]),f=xe.sub(o,s),h=xe.sub(a,u);return{distance:xe.mag(f),heading:xe.angleBetween(h,f),rotation:xe.angleBetween(h,xe.sub(c,l))}}return{distance:void 0,heading:void 0,rotation:void 0}}};function Ee(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return je(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return je(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Se(t,e){return Ft({attrs:{value:t.deviceId,label:t.label?t.label:e,selected:0===e}})}var ke=function(t){const e=t.DOM.select(".param-input").events("change").map(t=>[t.target.id,t.target.classList.contains("isCheck")?t.target.checked:t.target.value]),n=i.a.fromPromise(navigator.mediaDevices.enumerateDevices()).map(t=>t.filter(t=>"videoinput"===t.kind)),r=i.a.combine(n,t.config).map(t=>{let e=Ee(t,2),n=e[0],r=e[1];return Rt("#parameters-menu",{style:Kt},[Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Camera Feed ID"),Wt("#CAMERA_INDEX.param-input",{style:Jt},n.map(Se))]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Video Size"),Wt("#camera_params-videoSize.param-input",{style:Jt},[Ft({attrs:{value:0,label:"320 x 240",selected:0===r.camera_params.videoSize}}),Ft({attrs:{value:1,label:"640 x 480",selected:1===r.camera_params.videoSize}}),Ft({attrs:{value:2,label:"1280 x 720",selected:2===r.camera_params.videoSize}}),Ft({attrs:{value:3,label:"1920 x 1080",selected:3===r.camera_params.videoSize}})])]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Min Marker Distance"),$t("#detection_params-minMarkerDistance.param-input",{style:Jt,attrs:{type:"number",name:"MIN_MARKER_DISTANCE",min:1,max:50,value:r.detection_params.minMarkerDistance,step:1}})]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Min Marker Perimeter"),$t("#detection_params-minMarkerPerimeter.param-input",{style:Jt,attrs:{type:"number",name:"MIN_MARKER_PERIMETER",min:.01,max:.99,value:r.detection_params.minMarkerPerimeter,step:.01}})]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Max Marker Perimeter"),$t("#detection_params-maxMarkerPerimeter.param-input",{style:Jt,attrs:{type:"number",name:"MAX_MARKER_PERIMETER",min:.01,max:.99,value:r.detection_params.maxMarkerPerimeter,step:.01}})]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Size After Perspective Removal"),$t("#detection_params-sizeAfterPerspectiveRemoval.param-input",{style:Jt,attrs:{type:"number",name:"SIZE_AFTER_PERSPECTIVE_REMOVAL",min:1,max:200,value:r.detection_params.sizeAfterPerspectiveRemoval,step:1}})]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Contrast"),$t("#feed_params-contrast.param-input",{style:Jt,attrs:{type:"number",name:"IMAGE_CONTRAST",min:-100,max:100,value:r.feed_params.contrast,step:1}})]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Brightness"),$t("#feed_params-brightness.param-input",{style:Jt,attrs:{type:"number",name:"IMAGE_BRIGHTNESS",min:-100,max:100,value:r.feed_params.brightness,step:1}})]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Grayscale"),$t("#feed_params-grayscale.param-input",{style:Jt,attrs:{type:"number",name:"IMAGE_GRAYSCALE",min:0,max:100,value:r.feed_params.grayscale,step:1}})]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Flip Camera"),$t("#feed_params-flip.param-input.isCheck",{style:Jt,attrs:{type:"checkbox",name:"IMAGE_FLIP",checked:r.feed_params.flip}})]),Rt(".parameter-item",{style:Zt},[zt({style:Yt},"Torch Active"),$t("#camera_params-torch.param-input.isCheck",{style:Jt,attrs:{type:"checkbox",name:"TORCH",checked:r.camera_params.torch}})])])}),o=e.filter(t=>"CAMERA_INDEX"===t[0]).map(t=>t[1]).startWith(0);return{vdom$:r,configUpdate$:e.filter(t=>"CAMERA_INDEX"!==t[0]).map(t=>{let e=Ee(t,2),n=e[0],r=e[1];return t=>{const e=Ee(n.split("-"),2),i=e[0],o=e[1];return t[i][o]="boolean"!=typeof r?parseFloat(r):r,t}}),camID$:o}};function Ae(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Te(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ae(Object(n),!0).forEach((function(e){Ce(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ce(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function De(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Pe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pe(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const Ne=[],Ie=t=>{let e=De(t,3),n=e[0],r=e[1],i=e[2];const o=De(n,4),s=o[0],a=o[1],u=o[2],c=o[3];r.width!==u&&(r.width=u,r.height=c),i.clearRect(0,0,r.width,r.height),s.forEach(t=>{const e=Ne.find(e=>e.id===t.id);if(void 0===e)return;e.update(t);const n=t.center,r=t.corners,o=e.rotation;i.strokeStyle="#FF00AA",i.beginPath(),r.forEach((t,e)=>{i.moveTo(t.x,t.y);let n=r[(e+1)%r.length];i.lineTo(n.x,n.y)}),i.stroke(),i.closePath(),i.strokeStyle="blue",i.strokeRect(r[0].x-2,r[0].y-2,4,4),i.strokeStyle="#FF00AA",i.strokeRect(n.x-1,n.y-1,2,2),i.font="12px monospace",i.textAlign="center",i.fillStyle="#FF55AA",i.fillText("ID="+e.id,n.x,n.y-7),i.fillText(o.toFixed(2),n.x,n.y+15)}),Ne.forEach(t=>t.updatePresence(a))};function Le(t){const e=t.DOM.select("#toggle-screen").events("click").mapTo(t=>(t.overlay_params.hide=!t.overlay_params.hide,t)),n=(t.DOM.select("#beholder-video").element(),t.config.map(t=>t.overlay_params.hide)),r=t.config.map(t=>t.overlay_params.present),o=ke(t),a=o.camID$,u=t.config.map(t=>t.camera_params.videoSize).startWith(-1).compose(s.a).filter(t=>{let e=De(t,2);return e[0]!==e[1]}).map(t=>{let e=De(t,2);e[0];return e[1]}).startWith(0),c=t.config.map(t=>t.camera_params.torch).startWith(!1).compose(s.a).filter(t=>{let e=De(t,2);return e[0]!==e[1]}).map(t=>{let e=De(t,2);e[0];return e[1]}).startWith(!1),l=i.a.merge(i.a.of({width:320,height:240})).map(t=>Rt([Bt("#detection-canvas",{style:Ht,attrs:Te({},t)}),Bt("#detection-canvas-overlay",{style:Xt,attrs:Te({},t)})])),f=oe(t,{videoSize$:u,camID$:a,torch$:c}),h=_e(t),p=i.a.combine(r,n),d=i.a.combine(l,o.vdom$,f.vdom$),m=i.a.combine(p,d).map(t=>{let e=De(t,2),n=De(e[0],2),r=n[0],i=n[1],o=e[1];return Rt("#beholder-overlay",{overlayStyle:qt},[Rt("#toggle-screen",{style:r?Ut.main:Ut.none},"⥂"),Rt("#detection-panel",{style:i?Vt.main:Vt.active},o)])}),y=t.DOM.select("#detection-canvas-overlay").element(),v=y.map(t=>t.getContext("2d"));i.a.combine(h.marker$,y,v).subscribe({next:Ie});return{DOM:m,config:i.a.merge(o.configUpdate$,e)}}let Be,Re=Date.now();const $e=()=>i.a.create({start:t=>{Be=()=>{const e=Date.now(),n=e-Re;Re=e,t.next(n)}},stop:()=>{}}),Fe=()=>{Be()};function We(t){return t.overlay_params.hide=!0,t}function ze(t){return t.overlay_params.hide=!1,t}const Ge=i.a.create();const Ue={camera_params:{videoSize:1,torch:!1,rearCamera:!1},detection_params:{minMarkerDistance:10,minMarkerPerimeter:.02,maxMarkerPerimeter:.8,sizeAfterPerspectiveRemoval:49},feed_params:{contrast:0,brightness:0,grayscale:0,flip:!1},overlay_params:{present:!0,hide:!0}},qe=(t,e,n)=>{if(n)n.length<=0&&console.warn("BEHOLDER WARNING: your provided list of markers is empty, no markers will be tracked"),n.forEach(t=>Ne.push(new we(t)));else for(let t=0;t<100;t++)Ne.push(new we(t));const r=document.createElement("style");r.type="text/css",r.innerHTML=""+Qt.a,document.body.append(r);let o=Ue;e&&(e.camera_params&&(o.camera_params=Te(Te({},o.camera_params),e.camera_params)),e.detection_params&&(o.detection_params=Te(Te({},o.detection_params),e.detection_params)),e.feed_params&&(o.feed_params=Te(Te({},o.feed_params),e.feed_params)),e.overlay_params&&(o.overlay_params=Te(Te({},o.overlay_params),e.overlay_params)));var s;h(Le,{DOM:At(t),update:$e,config:(s=o,t=>i.a.merge(i.a.of(t=>t),t,Ge).fold((t,e)=>e(t),s))})},Ve=()=>Ne,He=t=>Ne.find(e=>e.id===t),Xe=(t,e)=>{new Me(Ne[t],Ne[e])};e.default={init:qe,update:Fe,getMarker:He,getMarkerPair:Xe,getAllMarkers:Ve,hide:()=>{Ge.shamefullySendNext(We)},show:()=>{Ge.shamefullySendNext(ze)},addVideoStreamListener:t=>{ie.push(t)}}}])}));